<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality.Factorisation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Prime factorisation of natural numbers and its properties</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--cubical-compatible</a> <a id="274" class="Pragma">--safe</a> <a id="281" class="Symbol">#-}</a>

<a id="286" class="Keyword">module</a> <a id="293" href="Data.Nat.Primality.Factorisation.html" class="Module">Data.Nat.Primality.Factorisation</a> <a id="326" class="Keyword">where</a>

<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="356" class="Keyword">using</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.Empty.html#1069" class="Function">⊥-elim</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a> <a id="494" class="Keyword">using</a> <a id="500" class="Symbol">(</a><a id="501" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a><a id="506" class="Symbol">;</a> <a id="508" href="Data.Nat.Induction.html#3201" class="Function">&lt;-rec</a><a id="513" class="Symbol">;</a> <a id="515" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a><a id="527" class="Symbol">)</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="Data.Product.html" class="Module">Data.Product</a> <a id="585" class="Symbol">as</a> <a id="588" class="Module">Π</a> <a id="590" class="Keyword">using</a> <a id="596" class="Symbol">(</a><a id="597" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="605" class="Symbol">;</a> <a id="607" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="610" class="Symbol">;</a> <a id="612" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="615" class="Symbol">;</a> <a id="617" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="622" class="Symbol">;</a> <a id="624" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="629" class="Symbol">)</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="658" class="Keyword">using</a> <a id="664" class="Symbol">(</a><a id="665" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="669" class="Symbol">;</a> <a id="671" href="Data.List.Base.html#7808" class="InductiveConstructor">[]</a><a id="673" class="Symbol">;</a> <a id="675" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="678" class="Symbol">;</a> <a id="680" href="Data.List.Base.html#1957" class="Function Operator">_++_</a><a id="684" class="Symbol">;</a> <a id="686" href="Data.List.Base.html#5054" class="Function">product</a><a id="693" class="Symbol">)</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a> <a id="707" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="742" class="Keyword">using</a> <a id="748" class="Symbol">(</a><a id="749" href="Data.List.Membership.Setoid.html#953" class="Function Operator">_∈_</a><a id="752" class="Symbol">)</a>
<a id="754" class="Keyword">open</a> <a id="759" class="Keyword">import</a> <a id="766" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="812" class="Keyword">using</a> <a id="818" class="Symbol">(</a><a id="819" href="Data.List.Membership.Propositional.Properties.html#4722" class="Function">∈-∃++</a><a id="824" class="Symbol">)</a>
<a id="826" class="Keyword">open</a> <a id="831" class="Keyword">import</a> <a id="838" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="867" class="Symbol">as</a> <a id="870" class="Module">All</a> <a id="874" class="Keyword">using</a> <a id="880" class="Symbol">(</a><a id="881" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a><a id="884" class="Symbol">;</a> <a id="886" href="Data.List.Relation.Unary.All.html#1693" class="InductiveConstructor">[]</a><a id="888" class="Symbol">;</a> <a id="890" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">_∷_</a><a id="893" class="Symbol">)</a>
<a id="895" class="Keyword">open</a> <a id="900" class="Keyword">import</a> <a id="907" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="936" class="Keyword">using</a> <a id="942" class="Symbol">(</a><a id="943" href="Data.List.Relation.Unary.Any.html#1229" class="InductiveConstructor">here</a><a id="947" class="Symbol">;</a> <a id="949" href="Data.List.Relation.Unary.Any.html#1282" class="InductiveConstructor">there</a><a id="954" class="Symbol">)</a>
<a id="956" class="Keyword">open</a> <a id="961" class="Keyword">import</a> <a id="968" href="Data.List.Relation.Binary.Permutation.Propositional.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional</a>
  <a id="1022" class="Keyword">using</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Data.List.Relation.Binary.Permutation.Propositional.html#1304" class="Datatype Operator">_↭_</a><a id="1032" class="Symbol">;</a> <a id="1034" href="Data.List.Relation.Binary.Permutation.Propositional.html#1367" class="InductiveConstructor">prep</a><a id="1038" class="Symbol">;</a> <a id="1040" href="Data.List.Relation.Binary.Permutation.Propositional.html#1419" class="InductiveConstructor">swap</a><a id="1044" class="Symbol">;</a> <a id="1046" href="Data.List.Relation.Binary.Permutation.Propositional.html#1631" class="Function">↭-reflexive</a><a id="1057" class="Symbol">;</a> <a id="1059" href="Data.List.Relation.Binary.Permutation.Propositional.html#1680" class="Function">↭-refl</a><a id="1065" class="Symbol">;</a> <a id="1067" href="Data.List.Relation.Binary.Permutation.Propositional.html#2025" class="Function">↭-trans</a><a id="1074" class="Symbol">;</a> <a id="1076" href="Data.List.Relation.Binary.Permutation.Propositional.html#1333" class="InductiveConstructor">refl</a><a id="1080" class="Symbol">;</a> <a id="1082" class="Keyword">module</a> <a id="1089" href="Data.List.Relation.Binary.Permutation.Propositional.html#2503" class="Module">PermutationReasoning</a><a id="1109" class="Symbol">)</a>
<a id="1111" class="Keyword">open</a> <a id="1116" class="Keyword">import</a> <a id="1123" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional.Properties</a> <a id="1186" class="Keyword">using</a> <a id="1192" class="Symbol">(</a><a id="1193" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#14037" class="Function">product-↭</a><a id="1202" class="Symbol">;</a> <a id="1204" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2797" class="Function">All-resp-↭</a><a id="1214" class="Symbol">;</a> <a id="1216" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#6893" class="Function">shift</a><a id="1221" class="Symbol">)</a>
<a id="1223" class="Keyword">open</a> <a id="1228" class="Keyword">import</a> <a id="1235" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="1249" class="Keyword">using</a> <a id="1255" class="Symbol">(</a><a id="1256" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="1260" class="Symbol">;</a> <a id="1262" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="1266" class="Symbol">)</a>
<a id="1268" class="Keyword">open</a> <a id="1273" class="Keyword">import</a> <a id="1280" href="Function.Base.html" class="Module">Function.Base</a> <a id="1294" class="Keyword">using</a> <a id="1300" class="Symbol">(</a><a id="1301" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="1304" class="Symbol">;</a> <a id="1306" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="1309" class="Symbol">;</a> <a id="1311" href="Function.Base.html#2127" class="Function Operator">_|&gt;_</a><a id="1315" class="Symbol">;</a> <a id="1317" href="Function.Base.html#1638" class="Function">flip</a><a id="1321" class="Symbol">)</a>
<a id="1323" class="Keyword">open</a> <a id="1328" class="Keyword">import</a> <a id="1335" href="Induction.html" class="Module">Induction</a> <a id="1345" class="Keyword">using</a> <a id="1351" class="Symbol">(</a><a id="1352" href="Induction.html#1485" class="Function">build</a><a id="1357" class="Symbol">)</a>
<a id="1359" class="Keyword">open</a> <a id="1364" class="Keyword">import</a> <a id="1371" href="Induction.Lexicographic.html" class="Module">Induction.Lexicographic</a> <a id="1395" class="Keyword">using</a> <a id="1401" class="Symbol">(</a><a id="1402" href="Induction.Lexicographic.html#791" class="Function Operator">_⊗_</a><a id="1405" class="Symbol">;</a> <a id="1407" href="Induction.Lexicographic.html#1764" class="Function Operator">[_⊗_]</a><a id="1412" class="Symbol">)</a>
<a id="1414" class="Keyword">open</a> <a id="1419" class="Keyword">import</a> <a id="1426" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1453" class="Keyword">using</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Relation.Nullary.Decidable.Core.html#1665" class="InductiveConstructor">yes</a><a id="1463" class="Symbol">;</a> <a id="1465" href="Relation.Nullary.Decidable.Core.html#1702" class="InductiveConstructor">no</a><a id="1467" class="Symbol">)</a>
<a id="1469" class="Keyword">open</a> <a id="1474" class="Keyword">import</a> <a id="1481" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1507" class="Keyword">using</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Relation.Nullary.Negation.Core.html#1226" class="Function">contradiction</a><a id="1527" class="Symbol">)</a>
<a id="1529" class="Keyword">open</a> <a id="1534" class="Keyword">import</a> <a id="1541" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1579" class="Keyword">using</a> <a id="1585" class="Symbol">(</a><a id="1586" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1589" class="Symbol">;</a> <a id="1591" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1595" class="Symbol">;</a> <a id="1597" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="1600" class="Symbol">;</a> <a id="1602" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a><a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="1613" class="Symbol">;</a> <a id="1615" class="Keyword">module</a> <a id="1622" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a><a id="1633" class="Symbol">)</a>

<a id="1636" class="Keyword">private</a>
  <a id="1646" class="Keyword">variable</a>
    <a id="1659" href="Data.Nat.Primality.Factorisation.html#1659" class="Generalizable">n</a> <a id="1661" class="Symbol">:</a> <a id="1663" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="1666" class="Comment">------------------------------------------------------------------------</a>
<a id="1739" class="Comment">-- Core definition</a>

<a id="1759" class="Keyword">record</a> <a id="PrimeFactorisation"></a><a id="1766" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="1785" class="Symbol">(</a><a id="1786" href="Data.Nat.Primality.Factorisation.html#1786" class="Bound">n</a> <a id="1788" class="Symbol">:</a> <a id="1790" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1791" class="Symbol">)</a> <a id="1793" class="Symbol">:</a> <a id="1795" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1799" class="Keyword">where</a>
  <a id="1807" class="Keyword">field</a>
    <a id="PrimeFactorisation.factors"></a><a id="1817" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="1825" class="Symbol">:</a> <a id="1827" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1832" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="PrimeFactorisation.isFactorisation"></a><a id="1838" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="1854" class="Symbol">:</a> <a id="1856" href="Data.Nat.Primality.Factorisation.html#1786" class="Bound">n</a> <a id="1858" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1860" href="Data.List.Base.html#5054" class="Function">product</a> <a id="1868" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a>
    <a id="PrimeFactorisation.factorsPrime"></a><a id="1880" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="1893" class="Symbol">:</a> <a id="1895" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a> <a id="1899" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="1905" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a>

<a id="1914" class="Keyword">open</a> <a id="1919" href="Data.Nat.Primality.Factorisation.html#1766" class="Module">PrimeFactorisation</a> <a id="1938" class="Keyword">public</a> <a id="1945" class="Keyword">using</a> <a id="1951" class="Symbol">(</a><a id="1952" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a><a id="1959" class="Symbol">)</a>
<a id="1961" class="Keyword">open</a> <a id="1966" href="Data.Nat.Primality.Factorisation.html#1766" class="Module">PrimeFactorisation</a>

<a id="1986" class="Comment">------------------------------------------------------------------------</a>
<a id="2059" class="Comment">-- Finding a factorisation</a>

<a id="primeFactorisation[1]"></a><a id="2087" href="Data.Nat.Primality.Factorisation.html#2087" class="Function">primeFactorisation[1]</a> <a id="2109" class="Symbol">:</a> <a id="2111" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="2130" class="Number">1</a>
<a id="2132" href="Data.Nat.Primality.Factorisation.html#2087" class="Function">primeFactorisation[1]</a> <a id="2154" class="Symbol">=</a> <a id="2156" class="Keyword">record</a>
  <a id="2165" class="Symbol">{</a> <a id="2167" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="2175" class="Symbol">=</a> <a id="2177" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2182" class="Symbol">;</a> <a id="2184" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="2200" class="Symbol">=</a> <a id="2202" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2209" class="Symbol">;</a> <a id="2211" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="2224" class="Symbol">=</a> <a id="2226" href="Data.List.Relation.Unary.All.html#1693" class="InductiveConstructor">[]</a>
  <a id="2231" class="Symbol">}</a>

<a id="primeFactorisation[p]"></a><a id="2234" href="Data.Nat.Primality.Factorisation.html#2234" class="Function">primeFactorisation[p]</a> <a id="2256" class="Symbol">:</a> <a id="2258" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="2264" href="Data.Nat.Primality.Factorisation.html#1659" class="Generalizable">n</a> <a id="2266" class="Symbol">→</a> <a id="2268" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="2287" href="Data.Nat.Primality.Factorisation.html#1659" class="Generalizable">n</a>
<a id="2289" href="Data.Nat.Primality.Factorisation.html#2234" class="Function">primeFactorisation[p]</a> <a id="2311" class="Symbol">{</a><a id="2312" href="Data.Nat.Primality.Factorisation.html#2312" class="Bound">n</a><a id="2313" class="Symbol">}</a> <a id="2315" href="Data.Nat.Primality.Factorisation.html#2315" class="Bound">pr</a> <a id="2318" class="Symbol">=</a> <a id="2320" class="Keyword">record</a>
  <a id="2329" class="Symbol">{</a> <a id="2331" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="2339" class="Symbol">=</a> <a id="2341" href="Data.Nat.Primality.Factorisation.html#2312" class="Bound">n</a> <a id="2343" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2345" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2350" class="Symbol">;</a> <a id="2352" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="2368" class="Symbol">=</a> <a id="2370" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2374" class="Symbol">(</a><a id="2375" href="Data.Nat.Properties.html#21075" class="Function">*-identityʳ</a> <a id="2387" href="Data.Nat.Primality.Factorisation.html#2312" class="Bound">n</a><a id="2388" class="Symbol">)</a>
  <a id="2392" class="Symbol">;</a> <a id="2394" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="2407" class="Symbol">=</a> <a id="2409" href="Data.Nat.Primality.Factorisation.html#2315" class="Bound">pr</a> <a id="2412" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">∷</a> <a id="2414" href="Data.List.Relation.Unary.All.html#1693" class="InductiveConstructor">[]</a>
  <a id="2419" class="Symbol">}</a>

<a id="2422" class="Comment">-- This builds up three important things:</a>
<a id="2464" class="Comment">-- * a proof that every number we&#39;ve gotten to so far has increasingly higher</a>
<a id="2542" class="Comment">--   possible least prime factor, so we don&#39;t have to repeat smaller factors</a>
<a id="2619" class="Comment">--   over and over (this is the &quot;m&quot; and &quot;rough&quot; parameters)</a>
<a id="2679" class="Comment">-- * a witness that this limit is getting closer to the number of interest, in a</a>
<a id="2760" class="Comment">--   way that helps the termination checker (the &quot;k&quot; and &quot;eq&quot; parameters)</a>
<a id="2834" class="Comment">-- * a proof that we can factorise any smaller number, which is useful when we</a>
<a id="2913" class="Comment">--   encounter a factor, as we can then divide by that factor and continue from</a>
<a id="2993" class="Comment">--   there without termination issues</a>
<a id="factorise"></a><a id="3031" href="Data.Nat.Primality.Factorisation.html#3031" class="Function">factorise</a> <a id="3041" class="Symbol">:</a> <a id="3043" class="Symbol">∀</a> <a id="3045" href="Data.Nat.Primality.Factorisation.html#3045" class="Bound">n</a> <a id="3047" class="Symbol">→</a> <a id="3049" class="Symbol">.{{</a><a id="3052" href="Data.Nat.Base.html#3260" class="Record">NonZero</a> <a id="3060" href="Data.Nat.Primality.Factorisation.html#3045" class="Bound">n</a><a id="3061" class="Symbol">}}</a> <a id="3064" class="Symbol">→</a> <a id="3066" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="3085" href="Data.Nat.Primality.Factorisation.html#3045" class="Bound">n</a>
<a id="3087" href="Data.Nat.Primality.Factorisation.html#3031" class="Function">factorise</a> <a id="3097" class="Number">1</a> <a id="3099" class="Symbol">=</a> <a id="3101" href="Data.Nat.Primality.Factorisation.html#2087" class="Function">primeFactorisation[1]</a>
<a id="3123" href="Data.Nat.Primality.Factorisation.html#3031" class="Function">factorise</a> <a id="3133" href="Data.Nat.Primality.Factorisation.html#3133" class="Bound">n₀</a><a id="3135" class="Symbol">@(</a><a id="3137" href="Data.Nat.Base.html#1095" class="InductiveConstructor">2+</a> <a id="3140" class="Symbol">_)</a> <a id="3143" class="Symbol">=</a> <a id="3145" href="Induction.html#1485" class="Function">build</a> <a id="3151" href="Induction.Lexicographic.html#1764" class="Function Operator">[</a> <a id="3153" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a> <a id="3166" href="Induction.Lexicographic.html#1764" class="Function Operator">⊗</a> <a id="3168" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a> <a id="3181" href="Induction.Lexicographic.html#1764" class="Function Operator">]</a> <a id="3183" href="Data.Nat.Primality.Factorisation.html#3233" class="Function">P</a> <a id="3185" href="Data.Nat.Primality.Factorisation.html#3367" class="Function">facRec</a> <a id="3192" class="Symbol">(</a><a id="3193" href="Data.Nat.Primality.Factorisation.html#3133" class="Bound">n₀</a> <a id="3196" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3198" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3202" href="Data.Nat.Primality.Factorisation.html#3133" class="Bound">n₀</a> <a id="3205" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3207" class="Number">4</a><a id="3208" class="Symbol">)</a> <a id="3210" href="Data.Nat.Primality.html#3990" class="Function">2-rough</a> <a id="3218" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="3225" class="Keyword">where</a>
  <a id="3233" href="Data.Nat.Primality.Factorisation.html#3233" class="Function">P</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3239" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3241" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3243" class="Symbol">→</a> <a id="3245" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="3251" href="Data.Nat.Primality.Factorisation.html#3233" class="Function">P</a> <a id="3253" class="Symbol">(</a><a id="3254" href="Data.Nat.Primality.Factorisation.html#3254" class="Bound">n</a> <a id="3256" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3258" href="Data.Nat.Primality.Factorisation.html#3258" class="Bound">k</a><a id="3259" class="Symbol">)</a> <a id="3261" class="Symbol">=</a> <a id="3263" class="Symbol">∀</a> <a id="3265" class="Symbol">{</a><a id="3266" href="Data.Nat.Primality.Factorisation.html#3266" class="Bound">m</a><a id="3267" class="Symbol">}</a> <a id="3269" class="Symbol">→</a> <a id="3271" class="Symbol">.{{</a><a id="3274" href="Data.Nat.Base.html#3795" class="Record">NonTrivial</a> <a id="3285" href="Data.Nat.Primality.Factorisation.html#3254" class="Bound">n</a><a id="3286" class="Symbol">}}</a> <a id="3289" class="Symbol">→</a> <a id="3291" class="Symbol">.{{</a><a id="3294" href="Data.Nat.Base.html#3795" class="Record">NonTrivial</a> <a id="3305" href="Data.Nat.Primality.Factorisation.html#3266" class="Bound">m</a><a id="3306" class="Symbol">}}</a> <a id="3309" class="Symbol">→</a> <a id="3311" href="Data.Nat.Primality.Factorisation.html#3266" class="Bound">m</a> <a id="3313" href="Data.Nat.Primality.html#2197" class="Function Operator">Rough</a> <a id="3319" href="Data.Nat.Primality.Factorisation.html#3254" class="Bound">n</a> <a id="3321" class="Symbol">→</a> <a id="3323" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3327" href="Data.Nat.Primality.Factorisation.html#3254" class="Bound">n</a> <a id="3329" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3331" href="Data.Nat.Primality.Factorisation.html#3266" class="Bound">m</a> <a id="3333" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3335" href="Data.Nat.Primality.Factorisation.html#3266" class="Bound">m</a> <a id="3337" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3339" href="Data.Nat.Primality.Factorisation.html#3258" class="Bound">k</a> <a id="3341" class="Symbol">→</a> <a id="3343" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="3362" href="Data.Nat.Primality.Factorisation.html#3254" class="Bound">n</a>

  <a id="3367" href="Data.Nat.Primality.Factorisation.html#3367" class="Function">facRec</a> <a id="3374" class="Symbol">:</a> <a id="3376" class="Symbol">∀</a> <a id="3378" href="Data.Nat.Primality.Factorisation.html#3378" class="Bound">n×k</a> <a id="3382" class="Symbol">→</a> <a id="3384" class="Symbol">(</a><a id="3385" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a> <a id="3391" href="Induction.Lexicographic.html#791" class="Function Operator">⊗</a> <a id="3393" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a><a id="3398" class="Symbol">)</a> <a id="3400" href="Data.Nat.Primality.Factorisation.html#3233" class="Function">P</a> <a id="3402" href="Data.Nat.Primality.Factorisation.html#3378" class="Bound">n×k</a> <a id="3406" class="Symbol">→</a> <a id="3408" href="Data.Nat.Primality.Factorisation.html#3233" class="Function">P</a> <a id="3410" href="Data.Nat.Primality.Factorisation.html#3378" class="Bound">n×k</a>
  <a id="3416" href="Data.Nat.Primality.Factorisation.html#3367" class="Function">facRec</a> <a id="3423" class="Symbol">(</a><a id="3424" href="Data.Nat.Primality.Factorisation.html#3424" class="Bound">n</a> <a id="3426" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3428" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="3432" class="Symbol">)</a> <a id="3434" class="Symbol">_</a> <a id="3436" href="Data.Nat.Primality.Factorisation.html#3436" class="Bound">rough</a> <a id="3442" href="Data.Nat.Primality.Factorisation.html#3442" class="Bound">eq</a> <a id="3445" class="Symbol">=</a>
  <a id="3449" class="Comment">-- Case 1: m * m &gt; n, ∴ Prime n</a>
    <a id="3485" href="Data.Nat.Primality.Factorisation.html#2234" class="Function">primeFactorisation[p]</a> <a id="3507" class="Symbol">(</a><a id="3508" href="Data.Nat.Primality.html#10276" class="Function">rough∧square&gt;⇒prime</a> <a id="3528" href="Data.Nat.Primality.Factorisation.html#3436" class="Bound">rough</a> <a id="3534" class="Symbol">(</a><a id="3535" href="Data.Nat.Properties.html#48146" class="Function">m∸n≡0⇒m≤n</a> <a id="3545" href="Data.Nat.Primality.Factorisation.html#3442" class="Bound">eq</a><a id="3547" class="Symbol">))</a>
  <a id="3552" href="Data.Nat.Primality.Factorisation.html#3367" class="Function">facRec</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Data.Nat.Primality.Factorisation.html#3560" class="Bound">n</a><a id="3561" class="Symbol">@(</a><a id="3563" href="Data.Nat.Base.html#1095" class="InductiveConstructor">2+</a> <a id="3566" class="Symbol">_)</a> <a id="3569" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3571" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3575" href="Data.Nat.Primality.Factorisation.html#3575" class="Bound">k</a><a id="3576" class="Symbol">)</a> <a id="3578" class="Symbol">(</a><a id="3579" href="Data.Nat.Primality.Factorisation.html#3579" class="Bound">recFactor</a> <a id="3589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3591" href="Data.Nat.Primality.Factorisation.html#3591" class="Bound">recQuotient</a><a id="3602" class="Symbol">)</a> <a id="3604" class="Symbol">{</a><a id="3605" href="Data.Nat.Primality.Factorisation.html#3605" class="Bound">m</a><a id="3606" class="Symbol">@(</a><a id="3608" href="Data.Nat.Base.html#1095" class="InductiveConstructor">2+</a> <a id="3611" class="Symbol">_)}</a> <a id="3615" href="Data.Nat.Primality.Factorisation.html#3615" class="Bound">rough</a> <a id="3621" href="Data.Nat.Primality.Factorisation.html#3621" class="Bound">eq</a> <a id="3624" class="Keyword">with</a> <a id="3629" href="Data.Nat.Primality.Factorisation.html#3605" class="Bound">m</a> <a id="3631" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="3634" href="Data.Nat.Primality.Factorisation.html#3560" class="Bound">n</a>
  <a id="3638" class="Comment">-- Case 2: m ∤ n, try larger m, reducing k accordingly</a>
  <a id="3695" class="Symbol">...</a> <a id="3699" class="Symbol">|</a> <a id="3701" href="Relation.Nullary.Decidable.Core.html#1702" class="InductiveConstructor">no</a> <a id="3704" href="Data.Nat.Primality.Factorisation.html#3704" class="Bound">m∤n</a> <a id="3708" class="Symbol">=</a> <a id="3710" class="Bound">recFactor</a> <a id="3720" class="Symbol">(</a><a id="3721" href="Data.Nat.Properties.html#10083" class="Function">≤-&lt;-trans</a> <a id="3731" class="Symbol">(</a><a id="3732" href="Data.Nat.Properties.html#46026" class="Function">m∸n≤m</a> <a id="3738" class="Bound">k</a> <a id="3740" class="Symbol">(</a><a id="3741" class="Bound">m</a> <a id="3743" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3745" class="Bound">m</a><a id="3746" class="Symbol">))</a> <a id="3749" class="Symbol">(</a><a id="3750" href="Data.Nat.Properties.html#12280" class="Function">n&lt;1+n</a> <a id="3756" class="Bound">k</a><a id="3757" class="Symbol">))</a> <a id="3760" class="Symbol">{</a><a id="3761" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3765" class="Bound">m</a><a id="3766" class="Symbol">}</a> <a id="3768" class="Symbol">(</a><a id="3769" href="Data.Nat.Primality.html#4304" class="Function">∤⇒rough-suc</a> <a id="3781" href="Data.Nat.Primality.Factorisation.html#3704" class="Bound">m∤n</a> <a id="3785" class="Bound">rough</a><a id="3790" class="Symbol">)</a> <a id="3792" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3794" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
    <a id="3804" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3808" class="Bound">n</a> <a id="3810" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3812" class="Symbol">(</a><a id="3813" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3817" class="Bound">m</a> <a id="3819" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3821" class="Bound">m</a> <a id="3823" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3825" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3829" class="Bound">m</a><a id="3830" class="Symbol">)</a>   <a id="3834" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="3837" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="3842" class="Symbol">(λ</a> <a id="3845" href="Data.Nat.Primality.Factorisation.html#3845" class="Bound">#</a> <a id="3847" class="Symbol">→</a> <a id="3849" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3853" class="Bound">n</a> <a id="3855" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3857" class="Symbol">(</a><a id="3858" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3862" class="Bound">m</a> <a id="3864" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3866" href="Data.Nat.Primality.Factorisation.html#3845" class="Bound">#</a><a id="3867" class="Symbol">))</a> <a id="3870" class="Symbol">(</a><a id="3871" href="Data.Nat.Properties.html#20447" class="Function">*-suc</a> <a id="3877" class="Bound">m</a> <a id="3879" class="Bound">m</a><a id="3880" class="Symbol">)</a> <a id="3882" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
    <a id="3888" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3892" class="Bound">n</a> <a id="3894" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3896" class="Symbol">(</a><a id="3897" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3901" class="Bound">m</a> <a id="3903" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3905" class="Symbol">(</a><a id="3906" class="Bound">m</a> <a id="3908" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3910" class="Bound">m</a> <a id="3912" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3914" class="Bound">m</a><a id="3915" class="Symbol">))</a> <a id="3918" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="3921" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="3926" class="Symbol">(</a><a id="3927" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3931" class="Bound">n</a> <a id="3933" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸_</a><a id="3935" class="Symbol">)</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Data.Nat.Properties.html#14550" class="Function">+-assoc</a> <a id="3946" class="Symbol">(</a><a id="3947" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3951" class="Bound">m</a><a id="3952" class="Symbol">)</a> <a id="3954" class="Bound">m</a> <a id="3956" class="Symbol">(</a><a id="3957" class="Bound">m</a> <a id="3959" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3961" class="Bound">m</a><a id="3962" class="Symbol">))</a> <a id="3965" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
    <a id="3971" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3975" class="Bound">n</a> <a id="3977" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="3979" class="Symbol">(</a><a id="3980" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3984" class="Symbol">(</a><a id="3985" class="Bound">m</a> <a id="3987" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3989" class="Bound">m</a><a id="3990" class="Symbol">)</a> <a id="3992" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3994" class="Bound">m</a> <a id="3996" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3998" class="Bound">m</a><a id="3999" class="Symbol">)</a> <a id="4001" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="4004" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4009" class="Symbol">(</a><a id="4010" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4014" class="Bound">n</a> <a id="4016" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸_</a><a id="4018" class="Symbol">)</a> <a id="4020" class="Symbol">(</a><a id="4021" href="Data.Nat.Properties.html#14883" class="Function">+-comm</a> <a id="4028" class="Symbol">(</a><a id="4029" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4033" class="Symbol">(</a><a id="4034" class="Bound">m</a> <a id="4036" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4038" class="Bound">m</a><a id="4039" class="Symbol">))</a> <a id="4042" class="Symbol">(</a><a id="4043" class="Bound">m</a> <a id="4045" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4047" class="Bound">m</a><a id="4048" class="Symbol">))</a> <a id="4051" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
    <a id="4057" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4061" class="Bound">n</a> <a id="4063" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="4065" class="Symbol">(</a><a id="4066" class="Bound">m</a> <a id="4068" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4070" class="Bound">m</a> <a id="4072" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4074" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4078" class="Symbol">(</a><a id="4079" class="Bound">m</a> <a id="4081" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4083" class="Bound">m</a><a id="4084" class="Symbol">))</a> <a id="4087" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="4090" href="Data.Nat.Properties.html#49137" class="Function">∸-+-assoc</a> <a id="4100" class="Symbol">(</a><a id="4101" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4105" class="Bound">n</a><a id="4106" class="Symbol">)</a> <a id="4108" class="Symbol">(</a><a id="4109" class="Bound">m</a> <a id="4111" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4113" class="Bound">m</a><a id="4114" class="Symbol">)</a> <a id="4116" class="Symbol">(</a><a id="4117" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4121" class="Symbol">(</a><a id="4122" class="Bound">m</a> <a id="4124" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4126" class="Bound">m</a><a id="4127" class="Symbol">))</a> <a id="4130" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
    <a id="4136" class="Symbol">(</a><a id="4137" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4141" class="Bound">n</a> <a id="4143" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="4145" class="Bound">m</a> <a id="4147" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4149" class="Bound">m</a><a id="4150" class="Symbol">)</a> <a id="4152" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="4154" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4158" class="Symbol">(</a><a id="4159" class="Bound">m</a> <a id="4161" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4163" class="Bound">m</a><a id="4164" class="Symbol">)</a> <a id="4166" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="4169" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4174" class="Symbol">(</a><a id="4175" href="Data.Nat.Base.html#4456" class="Primitive Operator">_∸</a> <a id="4178" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4182" class="Symbol">(</a><a id="4183" class="Bound">m</a> <a id="4185" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4187" class="Bound">m</a><a id="4188" class="Symbol">))</a> <a id="4191" class="Bound">eq</a> <a id="4194" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
    <a id="4200" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4204" class="Bound">k</a> <a id="4206" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="4208" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4212" class="Symbol">(</a><a id="4213" class="Bound">m</a> <a id="4215" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4217" class="Bound">m</a><a id="4218" class="Symbol">)</a>           <a id="4230" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="4236" class="Keyword">where</a> <a id="4242" class="Keyword">open</a> <a id="4247" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>
  <a id="4261" class="Comment">-- Case 3: m ∣ n, record m and recurse on the quotient</a>
  <a id="4318" class="Symbol">...</a> <a id="4322" class="Symbol">|</a> <a id="4324" href="Relation.Nullary.Decidable.Core.html#1665" class="InductiveConstructor">yes</a> <a id="4328" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a> <a id="4332" class="Symbol">=</a> <a id="4334" class="Keyword">record</a>
    <a id="4345" class="Symbol">{</a> <a id="4347" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="4355" class="Symbol">=</a> <a id="4357" class="Bound">m</a> <a id="4359" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4361" href="Data.Nat.Primality.Factorisation.html#4973" class="Function">ps</a>
    <a id="4368" class="Symbol">;</a> <a id="4370" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="4386" class="Symbol">=</a> <a id="4388" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="4392" href="Data.Nat.Primality.Factorisation.html#5056" class="Function">m*Πps≡n</a>
    <a id="4404" class="Symbol">;</a> <a id="4406" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="4419" class="Symbol">=</a> <a id="4421" href="Data.Nat.Primality.html#10095" class="Function">rough∧∣⇒prime</a> <a id="4435" class="Bound">rough</a> <a id="4441" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a> <a id="4445" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">∷</a> <a id="4447" href="Data.Nat.Primality.Factorisation.html#5010" class="Function">primes</a>
    <a id="4458" class="Symbol">}</a>
    <a id="4464" class="Keyword">where</a>
      <a id="4476" href="Data.Nat.Primality.Factorisation.html#4476" class="Function">m&lt;n</a> <a id="4480" class="Symbol">:</a> <a id="4482" class="Bound">m</a> <a id="4484" href="Data.Nat.Base.html#1801" class="Function Operator">&lt;</a> <a id="4486" class="Bound">n</a>
      <a id="4494" href="Data.Nat.Primality.Factorisation.html#4476" class="Function">m&lt;n</a> <a id="4498" class="Symbol">=</a> <a id="4500" href="Relation.Binary.Reasoning.Syntax.html#2946" class="Function Operator">begin-strict</a>
        <a id="4521" class="Bound">m</a>            <a id="4534" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">&lt;⟨</a> <a id="4537" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="4541" class="Symbol">(</a><a id="4542" href="Data.Nat.Properties.html#5425" class="Function">≤-trans</a> <a id="4550" class="Symbol">(</a><a id="4551" href="Data.Nat.Properties.html#18502" class="Function">m≤n+m</a> <a id="4557" class="Bound">m</a> <a id="4559" class="Symbol">_)</a> <a id="4562" class="Symbol">(</a><a id="4563" href="Data.Nat.Properties.html#19083" class="Function">+-monoʳ-≤</a> <a id="4573" class="Symbol">_</a> <a id="4575" class="Symbol">(</a><a id="4576" href="Data.Nat.Properties.html#18419" class="Function">m≤m+n</a> <a id="4582" class="Bound">m</a> <a id="4584" class="Symbol">_)))</a> <a id="4589" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">⟩</a>
        <a id="4599" href="Data.Nat.Base.html#5266" class="Function">pred</a> <a id="4604" class="Symbol">(</a><a id="4605" class="Bound">m</a> <a id="4607" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4609" class="Bound">m</a><a id="4610" class="Symbol">)</a> <a id="4612" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">&lt;⟨</a> <a id="4615" href="Data.Nat.Base.html#2085" class="Function">s&lt;s⁻¹</a> <a id="4621" class="Symbol">(</a><a id="4622" href="Data.Nat.Properties.html#48500" class="Function">m∸n≢0⇒n&lt;m</a> <a id="4632" class="Symbol">λ</a> <a id="4634" href="Data.Nat.Primality.Factorisation.html#4634" class="Bound">eq′</a> <a id="4638" class="Symbol">→</a> <a id="4640" href="Data.Nat.Properties.html#3833" class="Function">0≢1+n</a> <a id="4646" class="Symbol">(</a><a id="4647" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="4653" class="Symbol">(</a><a id="4654" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="4658" href="Data.Nat.Primality.Factorisation.html#4634" class="Bound">eq′</a><a id="4661" class="Symbol">)</a> <a id="4663" class="Bound">eq</a><a id="4665" class="Symbol">))</a> <a id="4668" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">⟩</a>
        <a id="4678" class="Bound">n</a>            <a id="4691" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="4701" class="Keyword">where</a> <a id="4707" class="Keyword">open</a> <a id="4712" href="Data.Nat.Properties.html#13933" class="Module">≤-Reasoning</a>

      <a id="4731" href="Data.Nat.Primality.Factorisation.html#4731" class="Function">q</a> <a id="4733" class="Symbol">=</a> <a id="4735" href="Data.Nat.Divisibility.Core.html#1215" class="Field">quotient</a> <a id="4744" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a>

      <a id="4755" class="Keyword">instance</a> <a id="4764" href="Data.Nat.Primality.Factorisation.html#4764" class="Function">_</a>  <a id="4767" class="Symbol">=</a> <a id="4769" href="Data.Nat.Base.html#3962" class="Function">n&gt;1⇒nonTrivial</a> <a id="4784" class="Symbol">(</a><a id="4785" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a> <a id="4796" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a> <a id="4800" href="Data.Nat.Primality.Factorisation.html#4476" class="Function">m&lt;n</a><a id="4803" class="Symbol">)</a>

      <a id="4812" href="Data.Nat.Primality.Factorisation.html#4812" class="Function">factorisation[q]</a> <a id="4829" class="Symbol">:</a> <a id="4831" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="4850" href="Data.Nat.Primality.Factorisation.html#4731" class="Function">q</a>
      <a id="4858" href="Data.Nat.Primality.Factorisation.html#4812" class="Function">factorisation[q]</a> <a id="4875" class="Symbol">=</a> <a id="4877" class="Bound">recQuotient</a> <a id="4889" class="Symbol">(</a><a id="4890" href="Data.Nat.Divisibility.html#2242" class="Function">quotient-&lt;</a> <a id="4901" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a><a id="4904" class="Symbol">)</a> <a id="4906" class="Symbol">(</a><a id="4907" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4911" href="Data.Nat.Primality.Factorisation.html#4731" class="Function">q</a> <a id="4913" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="4915" class="Bound">m</a> <a id="4917" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4919" class="Bound">m</a><a id="4920" class="Symbol">)</a> <a id="4922" class="Symbol">(</a><a id="4923" href="Data.Nat.Primality.html#4591" class="Function">rough∧∣⇒rough</a> <a id="4937" class="Bound">rough</a> <a id="4943" class="Symbol">(</a><a id="4944" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a> <a id="4955" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a><a id="4958" class="Symbol">))</a> <a id="4961" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

      <a id="4973" href="Data.Nat.Primality.Factorisation.html#4973" class="Function">ps</a> <a id="4976" class="Symbol">=</a> <a id="4978" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="4986" href="Data.Nat.Primality.Factorisation.html#4812" class="Function">factorisation[q]</a>

      <a id="5010" href="Data.Nat.Primality.Factorisation.html#5010" class="Function">primes</a> <a id="5017" class="Symbol">=</a> <a id="5019" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="5032" href="Data.Nat.Primality.Factorisation.html#4812" class="Function">factorisation[q]</a>

      <a id="5056" href="Data.Nat.Primality.Factorisation.html#5056" class="Function">m*Πps≡n</a> <a id="5064" class="Symbol">:</a> <a id="5066" class="Bound">m</a> <a id="5068" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5070" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5078" href="Data.Nat.Primality.Factorisation.html#4973" class="Function">ps</a> <a id="5081" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5083" class="Bound">n</a>
      <a id="5091" href="Data.Nat.Primality.Factorisation.html#5056" class="Function">m*Πps≡n</a> <a id="5099" class="Symbol">=</a> <a id="5101" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
        <a id="5115" class="Bound">m</a> <a id="5117" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5119" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5127" href="Data.Nat.Primality.Factorisation.html#4973" class="Function">ps</a> <a id="5130" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="5133" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="5138" class="Symbol">(</a><a id="5139" class="Bound">m</a> <a id="5141" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*_</a><a id="5143" class="Symbol">)</a> <a id="5145" class="Symbol">(</a><a id="5146" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="5162" href="Data.Nat.Primality.Factorisation.html#4812" class="Function">factorisation[q]</a><a id="5178" class="Symbol">)</a> <a id="5180" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
        <a id="5190" class="Bound">m</a> <a id="5192" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5194" href="Data.Nat.Primality.Factorisation.html#4731" class="Function">q</a>          <a id="5205" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="5208" href="Data.Nat.Divisibility.html#1713" class="Function">m∣n⇒n≡m*quotient</a> <a id="5225" href="Data.Nat.Primality.Factorisation.html#4328" class="Bound">m∣n</a> <a id="5229" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
        <a id="5239" class="Bound">n</a>              <a id="5254" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="5264" class="Keyword">where</a> <a id="5270" class="Keyword">open</a> <a id="5275" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

<a id="5288" class="Comment">------------------------------------------------------------------------</a>
<a id="5361" class="Comment">-- Properties of a factorisation</a>

<a id="factorisationHasAllPrimeFactors"></a><a id="5395" href="Data.Nat.Primality.Factorisation.html#5395" class="Function">factorisationHasAllPrimeFactors</a> <a id="5427" class="Symbol">:</a> <a id="5429" class="Symbol">∀</a> <a id="5431" class="Symbol">{</a><a id="5432" href="Data.Nat.Primality.Factorisation.html#5432" class="Bound">as</a><a id="5434" class="Symbol">}</a> <a id="5436" class="Symbol">{</a><a id="5437" href="Data.Nat.Primality.Factorisation.html#5437" class="Bound">p</a><a id="5438" class="Symbol">}</a> <a id="5440" class="Symbol">→</a> <a id="5442" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="5448" href="Data.Nat.Primality.Factorisation.html#5437" class="Bound">p</a> <a id="5450" class="Symbol">→</a> <a id="5452" href="Data.Nat.Primality.Factorisation.html#5437" class="Bound">p</a> <a id="5454" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="5456" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5464" href="Data.Nat.Primality.Factorisation.html#5432" class="Bound">as</a> <a id="5467" class="Symbol">→</a> <a id="5469" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a> <a id="5473" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="5479" href="Data.Nat.Primality.Factorisation.html#5432" class="Bound">as</a> <a id="5482" class="Symbol">→</a> <a id="5484" href="Data.Nat.Primality.Factorisation.html#5437" class="Bound">p</a> <a id="5486" href="Data.List.Membership.Setoid.html#953" class="Function Operator">∈</a> <a id="5488" href="Data.Nat.Primality.Factorisation.html#5432" class="Bound">as</a>
<a id="5491" href="Data.Nat.Primality.Factorisation.html#5395" class="Function">factorisationHasAllPrimeFactors</a> <a id="5523" class="Symbol">{</a><a id="5524" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5526" class="Symbol">}</a> <a id="5528" class="Symbol">{</a><a id="5529" href="Data.Nat.Base.html#1095" class="InductiveConstructor">2+</a> <a id="5532" href="Data.Nat.Primality.Factorisation.html#5532" class="Bound">p</a><a id="5533" class="Symbol">}</a> <a id="5535" href="Data.Nat.Primality.Factorisation.html#5535" class="Bound">pPrime</a> <a id="5542" href="Data.Nat.Primality.Factorisation.html#5542" class="Bound">p∣Πas</a> <a id="5548" href="Data.List.Relation.Unary.All.html#1693" class="InductiveConstructor">[]</a> <a id="5551" class="Symbol">=</a> <a id="5553" href="Relation.Nullary.Negation.Core.html#1226" class="Function">contradiction</a> <a id="5567" class="Symbol">(</a><a id="5568" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a> <a id="5574" href="Data.Nat.Primality.Factorisation.html#5542" class="Bound">p∣Πas</a><a id="5579" class="Symbol">)</a> <a id="5581" class="Symbol">λ</a> <a id="5583" class="Symbol">()</a>
<a id="5586" href="Data.Nat.Primality.Factorisation.html#5395" class="Function">factorisationHasAllPrimeFactors</a> <a id="5618" class="Symbol">{</a><a id="5619" href="Data.Nat.Primality.Factorisation.html#5619" class="Bound">a</a> <a id="5621" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5623" href="Data.Nat.Primality.Factorisation.html#5623" class="Bound">as</a><a id="5625" class="Symbol">}</a> <a id="5627" class="Symbol">{</a><a id="5628" href="Data.Nat.Primality.Factorisation.html#5628" class="Bound">p</a><a id="5629" class="Symbol">}</a> <a id="5631" href="Data.Nat.Primality.Factorisation.html#5631" class="Bound">pPrime</a> <a id="5638" href="Data.Nat.Primality.Factorisation.html#5638" class="Bound">p∣aΠas</a> <a id="5645" class="Symbol">(</a><a id="5646" href="Data.Nat.Primality.Factorisation.html#5646" class="Bound">aPrime</a> <a id="5653" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">∷</a> <a id="5655" href="Data.Nat.Primality.Factorisation.html#5655" class="Bound">asPrime</a><a id="5662" class="Symbol">)</a> <a id="5664" class="Keyword">with</a> <a id="5669" href="Data.Nat.Primality.html#8360" class="Function">euclidsLemma</a> <a id="5682" href="Data.Nat.Primality.Factorisation.html#5619" class="Bound">a</a> <a id="5684" class="Symbol">(</a><a id="5685" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5693" href="Data.Nat.Primality.Factorisation.html#5623" class="Bound">as</a><a id="5695" class="Symbol">)</a> <a id="5697" href="Data.Nat.Primality.Factorisation.html#5631" class="Bound">pPrime</a> <a id="5704" href="Data.Nat.Primality.Factorisation.html#5638" class="Bound">p∣aΠas</a>
<a id="5711" class="Symbol">...</a> <a id="5715" class="Symbol">|</a> <a id="5717" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="5722" href="Data.Nat.Primality.Factorisation.html#5722" class="Bound">p∣Πas</a> <a id="5728" class="Symbol">=</a> <a id="5730" href="Data.List.Relation.Unary.Any.html#1282" class="InductiveConstructor">there</a> <a id="5736" class="Symbol">(</a><a id="5737" href="Data.Nat.Primality.Factorisation.html#5395" class="Function">factorisationHasAllPrimeFactors</a> <a id="5769" class="Bound">pPrime</a> <a id="5776" href="Data.Nat.Primality.Factorisation.html#5722" class="Bound">p∣Πas</a> <a id="5782" class="Bound">asPrime</a><a id="5789" class="Symbol">)</a>
<a id="5791" class="Symbol">...</a> <a id="5795" class="Symbol">|</a> <a id="5797" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="5802" href="Data.Nat.Primality.Factorisation.html#5802" class="Bound">p∣a</a> <a id="5806" class="Keyword">with</a> <a id="5811" href="Data.Nat.Primality.html#13275" class="Function">prime⇒irreducible</a> <a id="5829" class="Bound">aPrime</a> <a id="5836" href="Data.Nat.Primality.Factorisation.html#5802" class="Bound">p∣a</a>
<a id="5840" class="Symbol">...</a>   <a id="5846" class="Symbol">|</a> <a id="5848" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="5853" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5858" class="Symbol">=</a> <a id="5860" href="Relation.Nullary.Negation.Core.html#1226" class="Function">contradiction</a> <a id="5874" class="Bound">pPrime</a> <a id="5881" href="Data.Nat.Primality.html#6972" class="Function">¬prime[1]</a>
<a id="5891" class="Symbol">...</a>   <a id="5897" class="Symbol">|</a> <a id="5899" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="5904" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5909" class="Symbol">=</a> <a id="5911" href="Data.List.Relation.Unary.Any.html#1229" class="InductiveConstructor">here</a> <a id="5916" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="5922" class="Keyword">private</a>
  <a id="factorisationUnique′"></a><a id="5932" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="5953" class="Symbol">:</a> <a id="5955" class="Symbol">(</a><a id="5956" href="Data.Nat.Primality.Factorisation.html#5956" class="Bound">as</a> <a id="5959" href="Data.Nat.Primality.Factorisation.html#5959" class="Bound">bs</a> <a id="5962" class="Symbol">:</a> <a id="5964" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5969" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5970" class="Symbol">)</a> <a id="5972" class="Symbol">→</a> <a id="5974" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5982" href="Data.Nat.Primality.Factorisation.html#5956" class="Bound">as</a> <a id="5985" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5987" href="Data.List.Base.html#5054" class="Function">product</a> <a id="5995" href="Data.Nat.Primality.Factorisation.html#5959" class="Bound">bs</a> <a id="5998" class="Symbol">→</a> <a id="6000" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a> <a id="6004" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="6010" href="Data.Nat.Primality.Factorisation.html#5956" class="Bound">as</a> <a id="6013" class="Symbol">→</a> <a id="6015" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a> <a id="6019" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="6025" href="Data.Nat.Primality.Factorisation.html#5959" class="Bound">bs</a> <a id="6028" class="Symbol">→</a> <a id="6030" href="Data.Nat.Primality.Factorisation.html#5956" class="Bound">as</a> <a id="6033" href="Data.List.Relation.Binary.Permutation.Propositional.html#1304" class="Datatype Operator">↭</a> <a id="6035" href="Data.Nat.Primality.Factorisation.html#5959" class="Bound">bs</a>
  <a id="6040" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="6061" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6064" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6067" href="Data.Nat.Primality.Factorisation.html#6067" class="Bound">Πas≡Πbs</a> <a id="6075" href="Data.Nat.Primality.Factorisation.html#6075" class="Bound">asPrime</a> <a id="6083" href="Data.Nat.Primality.Factorisation.html#6083" class="Bound">bsPrime</a> <a id="6091" class="Symbol">=</a> <a id="6093" href="Data.List.Relation.Binary.Permutation.Propositional.html#1333" class="InductiveConstructor">refl</a>
  <a id="6100" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="6121" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6124" class="Symbol">(</a><a id="6125" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a><a id="6126" class="Symbol">@(</a><a id="6128" href="Data.Nat.Base.html#1095" class="InductiveConstructor">2+</a> <a id="6131" class="Symbol">_)</a> <a id="6134" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6136" href="Data.Nat.Primality.Factorisation.html#6136" class="Bound">bs</a><a id="6138" class="Symbol">)</a> <a id="6140" href="Data.Nat.Primality.Factorisation.html#6140" class="Bound">Πas≡Πbs</a> <a id="6148" href="Data.Nat.Primality.Factorisation.html#6148" class="Bound">prime[as]</a> <a id="6158" class="Symbol">(_</a> <a id="6161" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">∷</a> <a id="6163" href="Data.Nat.Primality.Factorisation.html#6163" class="Bound">prime[bs]</a><a id="6172" class="Symbol">)</a> <a id="6174" class="Symbol">=</a>
    <a id="6180" href="Relation.Nullary.Negation.Core.html#1226" class="Function">contradiction</a> <a id="6194" href="Data.Nat.Primality.Factorisation.html#6140" class="Bound">Πas≡Πbs</a> <a id="6202" class="Symbol">(</a><a id="6203" href="Data.Nat.Properties.html#8499" class="Function">&lt;⇒≢</a> <a id="6207" href="Data.Nat.Primality.Factorisation.html#6232" class="Function">Πas&lt;Πbs</a><a id="6214" class="Symbol">)</a>
    <a id="6220" class="Keyword">where</a>
      <a id="6232" href="Data.Nat.Primality.Factorisation.html#6232" class="Function">Πas&lt;Πbs</a> <a id="6240" class="Symbol">:</a> <a id="6242" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6250" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6253" href="Data.Nat.Base.html#1801" class="Function Operator">&lt;</a> <a id="6255" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6263" class="Symbol">(</a><a id="6264" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a> <a id="6266" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6268" href="Data.Nat.Primality.Factorisation.html#6136" class="Bound">bs</a><a id="6270" class="Symbol">)</a>
      <a id="6278" href="Data.Nat.Primality.Factorisation.html#6232" class="Function">Πas&lt;Πbs</a> <a id="6286" class="Symbol">=</a> <a id="6288" href="Relation.Binary.Reasoning.Syntax.html#2946" class="Function Operator">begin-strict</a>
        <a id="6309" class="Number">1</a>                <a id="6326" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
        <a id="6338" class="Number">1</a> <a id="6340" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6342" class="Number">1</a>            <a id="6355" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">&lt;⟨</a> <a id="6358" href="Data.Nat.Properties.html#27296" class="Function">*-monoˡ-&lt;</a> <a id="6368" class="Number">1</a> <a id="6370" class="Symbol">{</a><a id="6371" class="Number">1</a><a id="6372" class="Symbol">}</a> <a id="6374" class="Symbol">{</a><a id="6375" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a><a id="6376" class="Symbol">}</a> <a id="6378" href="Data.Nat.Base.html#1955" class="InductiveConstructor">sz&lt;ss</a> <a id="6384" href="Relation.Binary.Reasoning.Syntax.html#5627" class="Function">⟩</a>
        <a id="6394" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a> <a id="6396" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6398" class="Number">1</a>            <a id="6411" href="Relation.Binary.Reasoning.Syntax.html#5482" class="Function">≤⟨</a> <a id="6414" href="Data.Nat.Properties.html#27043" class="Function">*-monoʳ-≤</a> <a id="6424" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a> <a id="6426" class="Symbol">(</a><a id="6427" href="Data.Nat.Primality.html#11535" class="Function">productOfPrimes≥1</a> <a id="6445" href="Data.Nat.Primality.Factorisation.html#6163" class="Bound">prime[bs]</a><a id="6454" class="Symbol">)</a> <a id="6456" href="Relation.Binary.Reasoning.Syntax.html#5482" class="Function">⟩</a>
        <a id="6466" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a> <a id="6468" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6470" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6478" href="Data.Nat.Primality.Factorisation.html#6136" class="Bound">bs</a>   <a id="6483" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
        <a id="6495" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6503" class="Symbol">(</a><a id="6504" href="Data.Nat.Primality.Factorisation.html#6125" class="Bound">b</a> <a id="6506" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6508" href="Data.Nat.Primality.Factorisation.html#6136" class="Bound">bs</a><a id="6510" class="Symbol">)</a> <a id="6512" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="6522" class="Keyword">where</a> <a id="6528" class="Keyword">open</a> <a id="6533" href="Data.Nat.Properties.html#13933" class="Module">≤-Reasoning</a>

  <a id="6548" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="6569" class="Symbol">(</a><a id="6570" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6572" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6574" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a><a id="6576" class="Symbol">)</a> <a id="6578" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a> <a id="6581" href="Data.Nat.Primality.Factorisation.html#6581" class="Bound">Πas≡Πbs</a> <a id="6589" class="Symbol">(</a><a id="6590" href="Data.Nat.Primality.Factorisation.html#6590" class="Bound">prime[a]</a> <a id="6599" href="Data.List.Relation.Unary.All.html#1710" class="InductiveConstructor Operator">∷</a> <a id="6601" href="Data.Nat.Primality.Factorisation.html#6601" class="Bound">prime[as]</a><a id="6610" class="Symbol">)</a> <a id="6612" href="Data.Nat.Primality.Factorisation.html#6612" class="Bound">prime[bs]</a> <a id="6622" class="Symbol">=</a> <a id="6624" href="Data.Nat.Primality.Factorisation.html#7526" class="Function">a∷as↭bs</a>
    <a id="6636" class="Keyword">where</a>
      <a id="6648" href="Data.Nat.Primality.Factorisation.html#6648" class="Function">a∣Πbs</a> <a id="6654" class="Symbol">:</a> <a id="6656" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6658" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="6660" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6668" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a>
      <a id="6677" href="Data.Nat.Primality.Factorisation.html#6648" class="Function">a∣Πbs</a> <a id="6683" class="Symbol">=</a> <a id="6685" href="Data.Nat.Divisibility.Core.html#1199" class="InductiveConstructor">divides</a> <a id="6693" class="Symbol">(</a><a id="6694" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6702" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a><a id="6704" class="Symbol">)</a> <a id="6706" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6708" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
        <a id="6722" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6730" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a>       <a id="6739" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="6742" href="Data.Nat.Primality.Factorisation.html#6581" class="Bound">Πas≡Πbs</a> <a id="6750" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
        <a id="6760" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6768" class="Symbol">(</a><a id="6769" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6771" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6773" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a><a id="6775" class="Symbol">)</a> <a id="6777" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
        <a id="6789" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6791" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6793" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6801" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a>   <a id="6806" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="6809" href="Data.Nat.Properties.html#21421" class="Function">*-comm</a> <a id="6816" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6818" class="Symbol">(</a><a id="6819" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6827" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a><a id="6829" class="Symbol">)</a> <a id="6831" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
        <a id="6841" href="Data.List.Base.html#5054" class="Function">product</a> <a id="6849" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a> <a id="6852" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6854" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a>   <a id="6858" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="6868" class="Keyword">where</a> <a id="6874" class="Keyword">open</a> <a id="6879" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

      <a id="6898" href="Data.Nat.Primality.Factorisation.html#6898" class="Function">shuffle</a> <a id="6906" class="Symbol">:</a> <a id="6908" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="6911" href="Data.Nat.Primality.Factorisation.html#6911" class="Bound">bs′</a> <a id="6915" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="6917" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a> <a id="6920" href="Data.List.Relation.Binary.Permutation.Propositional.html#1304" class="Datatype Operator">↭</a> <a id="6922" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="6924" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6926" href="Data.Nat.Primality.Factorisation.html#6911" class="Bound">bs′</a>
      <a id="6936" href="Data.Nat.Primality.Factorisation.html#6898" class="Function">shuffle</a> <a id="6944" class="Keyword">with</a> <a id="6949" href="Data.Nat.Primality.Factorisation.html#6949" class="Bound">ys</a> <a id="6952" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6954" href="Data.Nat.Primality.Factorisation.html#6954" class="Bound">zs</a> <a id="6957" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6959" href="Data.Nat.Primality.Factorisation.html#6959" class="Bound">p</a> ← <a id="6963" href="Data.List.Membership.Propositional.Properties.html#4722" class="Function">∈-∃++</a> <a id="6969" class="Symbol">(</a><a id="6970" href="Data.Nat.Primality.Factorisation.html#5395" class="Function">factorisationHasAllPrimeFactors</a> <a id="7002" href="Data.Nat.Primality.Factorisation.html#6590" class="Bound">prime[a]</a> <a id="7011" href="Data.Nat.Primality.Factorisation.html#6648" class="Function">a∣Πbs</a> <a id="7017" href="Data.Nat.Primality.Factorisation.html#6612" class="Bound">prime[bs]</a><a id="7026" class="Symbol">)</a>
        <a id="7036" class="Symbol">=</a> <a id="7038" href="Data.Nat.Primality.Factorisation.html#6949" class="Bound">ys</a> <a id="7041" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="7044" href="Data.Nat.Primality.Factorisation.html#6954" class="Bound">zs</a> <a id="7047" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7049" href="Data.List.Relation.Binary.Permutation.Propositional.html#2025" class="Function">↭-trans</a> <a id="7057" class="Symbol">(</a><a id="7058" href="Data.List.Relation.Binary.Permutation.Propositional.html#1631" class="Function">↭-reflexive</a> <a id="7070" href="Data.Nat.Primality.Factorisation.html#6959" class="Bound">p</a><a id="7071" class="Symbol">)</a> <a id="7073" class="Symbol">(</a><a id="7074" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#6893" class="Function">shift</a> <a id="7080" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7082" href="Data.Nat.Primality.Factorisation.html#6949" class="Bound">ys</a> <a id="7085" href="Data.Nat.Primality.Factorisation.html#6954" class="Bound">zs</a><a id="7087" class="Symbol">)</a>

      <a id="7096" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a> <a id="7100" class="Symbol">=</a> <a id="7102" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7108" href="Data.Nat.Primality.Factorisation.html#6898" class="Function">shuffle</a>
      <a id="7122" href="Data.Nat.Primality.Factorisation.html#7122" class="Function">bs↭a∷bs′</a> <a id="7131" class="Symbol">=</a> <a id="7133" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="7139" href="Data.Nat.Primality.Factorisation.html#6898" class="Function">shuffle</a>

      <a id="7154" href="Data.Nat.Primality.Factorisation.html#7154" class="Function">Πas≡Πbs′</a> <a id="7163" class="Symbol">:</a> <a id="7165" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7173" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a> <a id="7176" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7178" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7186" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a>
      <a id="7196" href="Data.Nat.Primality.Factorisation.html#7154" class="Function">Πas≡Πbs′</a> <a id="7205" class="Symbol">=</a> <a id="7207" href="Data.Nat.Properties.html#24794" class="Function">*-cancelˡ-≡</a> <a id="7219" class="Symbol">(</a><a id="7220" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7228" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a><a id="7230" class="Symbol">)</a> <a id="7232" class="Symbol">(</a><a id="7233" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7241" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a><a id="7244" class="Symbol">)</a> <a id="7246" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7248" class="Symbol">{{</a><a id="7250" href="Data.Nat.Primality.html#7053" class="Function">prime⇒nonZero</a> <a id="7264" href="Data.Nat.Primality.Factorisation.html#6590" class="Bound">prime[a]</a><a id="7272" class="Symbol">}}</a> <a id="7275" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7277" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
        <a id="7291" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7293" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7295" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7303" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a>  <a id="7307" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="7310" href="Data.Nat.Primality.Factorisation.html#6581" class="Bound">Πas≡Πbs</a> <a id="7318" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
        <a id="7328" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7336" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a>      <a id="7344" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="7347" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#14037" class="Function">product-↭</a> <a id="7357" href="Data.Nat.Primality.Factorisation.html#7122" class="Function">bs↭a∷bs′</a> <a id="7366" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
        <a id="7376" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7378" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7380" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7388" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a> <a id="7392" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="7402" class="Keyword">where</a> <a id="7408" class="Keyword">open</a> <a id="7413" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

      <a id="7432" href="Data.Nat.Primality.Factorisation.html#7432" class="Function">prime[bs&#39;]</a> <a id="7443" class="Symbol">:</a> <a id="7445" href="Data.List.Relation.Unary.All.html#1630" class="Datatype">All</a> <a id="7449" href="Data.Nat.Primality.html#3094" class="Record">Prime</a> <a id="7455" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a>
      <a id="7465" href="Data.Nat.Primality.Factorisation.html#7432" class="Function">prime[bs&#39;]</a> <a id="7476" class="Symbol">=</a> <a id="7478" href="Data.List.Relation.Unary.All.html#2594" class="Function">All.tail</a> <a id="7487" class="Symbol">(</a><a id="7488" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2797" class="Function">All-resp-↭</a> <a id="7499" href="Data.Nat.Primality.Factorisation.html#7122" class="Function">bs↭a∷bs′</a> <a id="7508" href="Data.Nat.Primality.Factorisation.html#6612" class="Bound">prime[bs]</a><a id="7517" class="Symbol">)</a>

      <a id="7526" href="Data.Nat.Primality.Factorisation.html#7526" class="Function">a∷as↭bs</a> <a id="7534" class="Symbol">:</a> <a id="7536" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7538" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7540" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a> <a id="7543" href="Data.List.Relation.Binary.Permutation.Propositional.html#1304" class="Datatype Operator">↭</a> <a id="7545" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a>
      <a id="7554" href="Data.Nat.Primality.Factorisation.html#7526" class="Function">a∷as↭bs</a> <a id="7562" class="Symbol">=</a> <a id="7564" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
        <a id="7578" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7580" href="Data.List.Relation.Binary.Permutation.Propositional.html#2880" class="Function">∷</a> <a id="7582" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a>  <a id="7586" href="Data.List.Relation.Binary.Permutation.Propositional.html#2880" class="Function">&lt;⟨</a> <a id="7589" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="7610" href="Data.Nat.Primality.Factorisation.html#6574" class="Bound">as</a> <a id="7613" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a> <a id="7617" href="Data.Nat.Primality.Factorisation.html#7154" class="Function">Πas≡Πbs′</a> <a id="7626" href="Data.Nat.Primality.Factorisation.html#6601" class="Bound">prime[as]</a> <a id="7636" href="Data.Nat.Primality.Factorisation.html#7432" class="Function">prime[bs&#39;]</a> <a id="7647" href="Data.List.Relation.Binary.Permutation.Propositional.html#2880" class="Function">⟩</a>
        <a id="7657" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">a</a> <a id="7659" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7661" href="Data.Nat.Primality.Factorisation.html#7096" class="Function">bs′</a> <a id="7665" href="Relation.Binary.Reasoning.Syntax.html#9882" class="Function">↭⟨</a> <a id="7668" href="Data.Nat.Primality.Factorisation.html#7122" class="Function">bs↭a∷bs′</a> <a id="7677" href="Relation.Binary.Reasoning.Syntax.html#9882" class="Function">⟨</a>
        <a id="7687" href="Data.Nat.Primality.Factorisation.html#6578" class="Bound">bs</a>      <a id="7695" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
        <a id="7705" class="Keyword">where</a> <a id="7711" class="Keyword">open</a> <a id="7716" href="Data.List.Relation.Binary.Permutation.Propositional.html#2503" class="Module">PermutationReasoning</a>

<a id="factorisationUnique"></a><a id="7738" href="Data.Nat.Primality.Factorisation.html#7738" class="Function">factorisationUnique</a> <a id="7758" class="Symbol">:</a> <a id="7760" class="Symbol">(</a><a id="7761" href="Data.Nat.Primality.Factorisation.html#7761" class="Bound">f</a> <a id="7763" href="Data.Nat.Primality.Factorisation.html#7763" class="Bound">f′</a> <a id="7766" class="Symbol">:</a> <a id="7768" href="Data.Nat.Primality.Factorisation.html#1766" class="Record">PrimeFactorisation</a> <a id="7787" href="Data.Nat.Primality.Factorisation.html#1659" class="Generalizable">n</a><a id="7788" class="Symbol">)</a> <a id="7790" class="Symbol">→</a> <a id="7792" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7800" href="Data.Nat.Primality.Factorisation.html#7761" class="Bound">f</a> <a id="7802" href="Data.List.Relation.Binary.Permutation.Propositional.html#1304" class="Datatype Operator">↭</a> <a id="7804" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7812" href="Data.Nat.Primality.Factorisation.html#7763" class="Bound">f′</a>
<a id="7815" href="Data.Nat.Primality.Factorisation.html#7738" class="Function">factorisationUnique</a> <a id="7835" class="Symbol">{</a><a id="7836" href="Data.Nat.Primality.Factorisation.html#7836" class="Bound">n</a><a id="7837" class="Symbol">}</a> <a id="7839" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a> <a id="7841" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a> <a id="7844" class="Symbol">=</a>
  <a id="7848" href="Data.Nat.Primality.Factorisation.html#5932" class="Function">factorisationUnique′</a> <a id="7869" class="Symbol">(</a><a id="7870" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7878" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a><a id="7879" class="Symbol">)</a> <a id="7881" class="Symbol">(</a><a id="7882" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7890" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a><a id="7892" class="Symbol">)</a> <a id="7894" href="Data.Nat.Primality.Factorisation.html#7948" class="Function">Πf≡Πf′</a> <a id="7901" class="Symbol">(</a><a id="7902" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="7915" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a><a id="7916" class="Symbol">)</a> <a id="7918" class="Symbol">(</a><a id="7919" href="Data.Nat.Primality.Factorisation.html#1880" class="Field">factorsPrime</a> <a id="7932" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a><a id="7934" class="Symbol">)</a>
  <a id="7938" class="Keyword">where</a>
    <a id="7948" href="Data.Nat.Primality.Factorisation.html#7948" class="Function">Πf≡Πf′</a> <a id="7955" class="Symbol">:</a> <a id="7957" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7965" class="Symbol">(</a><a id="7966" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7974" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a><a id="7975" class="Symbol">)</a> <a id="7977" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7979" href="Data.List.Base.html#5054" class="Function">product</a> <a id="7987" class="Symbol">(</a><a id="7988" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="7996" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a><a id="7998" class="Symbol">)</a>
    <a id="8004" href="Data.Nat.Primality.Factorisation.html#7948" class="Function">Πf≡Πf′</a> <a id="8011" class="Symbol">=</a> <a id="8013" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="8025" href="Data.List.Base.html#5054" class="Function">product</a> <a id="8033" class="Symbol">(</a><a id="8034" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="8042" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a><a id="8043" class="Symbol">)</a>  <a id="8046" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">≡⟨</a> <a id="8049" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="8065" href="Data.Nat.Primality.Factorisation.html#7839" class="Bound">f</a> <a id="8067" href="Relation.Binary.Reasoning.Syntax.html#11078" class="Function">⟨</a>
      <a id="8075" href="Data.Nat.Primality.Factorisation.html#7836" class="Bound">n</a>                    <a id="8096" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="8099" href="Data.Nat.Primality.Factorisation.html#1838" class="Field">isFactorisation</a> <a id="8115" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a> <a id="8118" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="8126" href="Data.List.Base.html#5054" class="Function">product</a> <a id="8134" class="Symbol">(</a><a id="8135" href="Data.Nat.Primality.Factorisation.html#1817" class="Field">factors</a> <a id="8143" href="Data.Nat.Primality.Factorisation.html#7841" class="Bound">f′</a><a id="8145" class="Symbol">)</a> <a id="8147" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
      <a id="8155" class="Keyword">where</a> <a id="8161" class="Keyword">open</a> <a id="8166" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>
</pre></body></html>