<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="289" class="Keyword">using</a> <a id="295" class="Symbol">(</a><a id="296" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a><a id="309" class="Symbol">)</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Char.html" class="Module">Data.Char</a> <a id="333" class="Symbol">as</a> <a id="336" class="Module">Char</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Function.Base.html" class="Module">Function.Base</a> <a id="380" class="Keyword">using</a> <a id="386" class="Symbol">(</a><a id="387" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="390" class="Symbol">;</a> <a id="392" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="395" class="Symbol">)</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="423" class="Symbol">as</a> <a id="426" class="Module">ℕ</a> <a id="428" class="Keyword">using</a> <a id="434" class="Symbol">(</a><a id="435" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">import</a> <a id="445" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="465" class="Symbol">as</a> <a id="468" class="Module">ℕ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="516" class="Symbol">)</a>
<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="548" href="Data.Nat.Properties.html#7413" class="Function">ℕ.≤-totalOrder</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="589" class="Symbol">as</a> <a id="592" class="Module">Vec</a> <a id="596" class="Keyword">using</a> <a id="602" class="Symbol">(</a><a id="603" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a><a id="606" class="Symbol">)</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="635" class="Symbol">as</a> <a id="638" class="Module">Char</a> <a id="643" class="Keyword">using</a> <a id="649" class="Symbol">(</a><a id="650" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a><a id="654" class="Symbol">)</a>
<a id="656" class="Keyword">import</a> <a id="663" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="684" class="Symbol">as</a> <a id="687" class="Module">Char</a> <a id="692" class="Keyword">using</a> <a id="698" class="Symbol">(</a><a id="699" href="Data.Char.Properties.html#2059" class="Function Operator">_≟_</a><a id="702" class="Symbol">)</a>
<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="748" class="Keyword">using</a> <a id="754" class="Symbol">(</a><a id="755" href="Relation.Nullary.Decidable.Core.html#1598" class="Field">does</a><a id="759" class="Symbol">)</a>

<a id="762" class="Keyword">open</a> <a id="767" class="Keyword">import</a> <a id="774" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="812" href="Data.Char.Properties.html#2059" class="Function Operator">Char._≟_</a>


<a id="823" class="Comment">------------------------------------------------------------------------</a>
<a id="896" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="957" class="Keyword">open</a> <a id="962" class="Keyword">import</a> <a id="969" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="986" class="Keyword">public</a>
<a id="993" class="Keyword">open</a> <a id="998" class="Keyword">import</a> <a id="1005" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1028" class="Keyword">using</a> <a id="1034" class="Symbol">(</a><a id="1035" href="Data.String.Properties.html#2034" class="Function Operator">_≈?_</a><a id="1039" class="Symbol">;</a> <a id="1041" href="Data.String.Properties.html#2714" class="Function Operator">_≟_</a><a id="1044" class="Symbol">;</a> <a id="1046" href="Data.String.Properties.html#3000" class="Function Operator">_&lt;?_</a><a id="1050" class="Symbol">;</a> <a id="1052" href="Data.String.Properties.html#4769" class="Function Operator">_==_</a><a id="1056" class="Symbol">)</a> <a id="1058" class="Keyword">public</a>

<a id="1066" class="Comment">------------------------------------------------------------------------</a>
<a id="1139" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1164" href="Data.String.html#1164" class="Function">toVec</a> <a id="1170" class="Symbol">:</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Data.String.html#1173" class="Bound">s</a> <a id="1175" class="Symbol">:</a> <a id="1177" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1183" class="Symbol">)</a> <a id="1185" class="Symbol">→</a> <a id="1187" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1191" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1196" class="Symbol">(</a><a id="1197" href="Data.String.Base.html#2468" class="Function">length</a> <a id="1204" href="Data.String.html#1173" class="Bound">s</a><a id="1205" class="Symbol">)</a>
<a id="1207" href="Data.String.html#1164" class="Function">toVec</a> <a id="1213" href="Data.String.html#1213" class="Bound">s</a> <a id="1215" class="Symbol">=</a> <a id="1217" href="Data.Vec.Base.html#8518" class="Function">Vec.fromList</a> <a id="1230" class="Symbol">(</a><a id="1231" href="Data.String.Base.html#1537" class="Primitive">toList</a> <a id="1238" href="Data.String.html#1213" class="Bound">s</a><a id="1239" class="Symbol">)</a>

<a id="fromVec"></a><a id="1242" href="Data.String.html#1242" class="Function">fromVec</a> <a id="1250" class="Symbol">:</a> <a id="1252" class="Symbol">∀</a> <a id="1254" class="Symbol">{</a><a id="1255" href="Data.String.html#1255" class="Bound">n</a><a id="1256" class="Symbol">}</a> <a id="1258" class="Symbol">→</a> <a id="1260" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1264" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1269" href="Data.String.html#1255" class="Bound">n</a> <a id="1271" class="Symbol">→</a> <a id="1273" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1280" href="Data.String.html#1242" class="Function">fromVec</a> <a id="1288" class="Symbol">=</a> <a id="1290" href="Data.String.Base.html#1570" class="Primitive">fromList</a> <a id="1299" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1301" href="Data.Vec.Base.html#8424" class="Function">Vec.toList</a>


<a id="1314" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1377" href="Data.String.html#1377" class="Function">parensIfSpace</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1400" class="Symbol">→</a> <a id="1402" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1409" href="Data.String.html#1377" class="Function">parensIfSpace</a> <a id="1423" href="Data.String.html#1423" class="Bound">s</a> <a id="1425" class="Symbol">=</a> <a id="1427" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1430" href="Relation.Nullary.Decidable.Core.html#1598" class="Field">does</a> <a id="1435" class="Symbol">(</a><a id="1436" class="String">&#39; &#39;</a> <a id="1440" href="Data.List.Membership.DecSetoid.html#882" class="Function Operator">∈?</a> <a id="1443" href="Data.String.Base.html#1537" class="Primitive">toList</a> <a id="1450" href="Data.String.html#1423" class="Bound">s</a><a id="1451" class="Symbol">)</a> <a id="1453" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1458" href="Data.String.Base.html#2864" class="Function">parens</a> <a id="1465" href="Data.String.html#1423" class="Bound">s</a> <a id="1467" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="1472" href="Data.String.html#1423" class="Bound">s</a>


<a id="1476" class="Comment">------------------------------------------------------------------------</a>
<a id="1549" class="Comment">-- Rectangle</a>

<a id="1563" class="Comment">-- Build a rectangular column by:</a>
<a id="1597" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="1660" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="1728" href="Data.String.html#1728" class="Function">rectangle</a> <a id="1738" class="Symbol">:</a> <a id="1740" class="Symbol">∀</a> <a id="1742" class="Symbol">{</a><a id="1743" href="Data.String.html#1743" class="Bound">n</a><a id="1744" class="Symbol">}</a> <a id="1746" class="Symbol">→</a> <a id="1748" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1752" class="Symbol">(</a><a id="1753" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1755" class="Symbol">→</a> <a id="1757" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1764" class="Symbol">→</a> <a id="1766" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1772" class="Symbol">)</a> <a id="1774" href="Data.String.html#1743" class="Bound">n</a> <a id="1776" class="Symbol">→</a>
            <a id="1790" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1794" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1801" href="Data.String.html#1743" class="Bound">n</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1809" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1816" href="Data.String.html#1743" class="Bound">n</a>
<a id="1818" href="Data.String.html#1728" class="Function">rectangle</a> <a id="1828" href="Data.String.html#1828" class="Bound">pads</a> <a id="1833" href="Data.String.html#1833" class="Bound">cells</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="Data.Vec.Base.html#3740" class="Function">Vec.zipWith</a> <a id="1853" class="Symbol">(λ</a> <a id="1856" href="Data.String.html#1856" class="Bound">p</a> <a id="1858" href="Data.String.html#1858" class="Bound">c</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.String.html#1856" class="Bound">p</a> <a id="1864" href="Data.String.html#1938" class="Function">width</a> <a id="1870" href="Data.String.html#1858" class="Bound">c</a><a id="1871" class="Symbol">)</a> <a id="1873" href="Data.String.html#1828" class="Bound">pads</a> <a id="1878" href="Data.String.html#1833" class="Bound">cells</a> <a id="1884" class="Keyword">where</a>

  <a id="1893" href="Data.String.html#1893" class="Function">sizes</a> <a id="1899" class="Symbol">=</a> <a id="1901" href="Data.List.Base.html#1634" class="Function">List.map</a> <a id="1910" href="Data.String.Base.html#2468" class="Function">length</a> <a id="1917" class="Symbol">(</a><a id="1918" href="Data.Vec.Base.html#8424" class="Function">Vec.toList</a> <a id="1929" href="Data.String.html#1833" class="Bound">cells</a><a id="1934" class="Symbol">)</a>
  <a id="1938" href="Data.String.html#1938" class="Function">width</a> <a id="1944" class="Symbol">=</a> <a id="1946" href="Data.List.Extrema.html#1941" class="Function">max</a> <a id="1950" class="Number">0</a> <a id="1952" href="Data.String.html#1893" class="Function">sizes</a>

<a id="1959" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2015" href="Data.String.html#2015" class="Function">rectangleˡ</a> <a id="2026" class="Symbol">:</a> <a id="2028" class="Symbol">∀</a> <a id="2030" class="Symbol">{</a><a id="2031" href="Data.String.html#2031" class="Bound">n</a><a id="2032" class="Symbol">}</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2041" class="Symbol">→</a> <a id="2043" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2047" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2054" href="Data.String.html#2031" class="Bound">n</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2062" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2069" href="Data.String.html#2031" class="Bound">n</a>
<a id="2071" href="Data.String.html#2015" class="Function">rectangleˡ</a> <a id="2082" href="Data.String.html#2082" class="Bound">c</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Data.String.html#1728" class="Function">rectangle</a> <a id="2096" class="Symbol">(</a><a id="2097" href="Data.Vec.Base.html#6515" class="Function">Vec.replicate</a> <a id="2111" class="Symbol">_</a> <a id="2113" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2115" href="Data.String.Base.html#3596" class="Function">padLeft</a> <a id="2123" href="Data.String.html#2082" class="Bound">c</a><a id="2124" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2127" href="Data.String.html#2127" class="Function">rectangleʳ</a> <a id="2138" class="Symbol">:</a> <a id="2140" class="Symbol">∀</a> <a id="2142" class="Symbol">{</a><a id="2143" href="Data.String.html#2143" class="Bound">n</a><a id="2144" class="Symbol">}</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2153" class="Symbol">→</a> <a id="2155" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2159" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2166" href="Data.String.html#2143" class="Bound">n</a> <a id="2168" class="Symbol">→</a> <a id="2170" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2174" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2181" href="Data.String.html#2143" class="Bound">n</a>
<a id="2183" href="Data.String.html#2127" class="Function">rectangleʳ</a> <a id="2194" href="Data.String.html#2194" class="Bound">c</a> <a id="2196" class="Symbol">=</a> <a id="2198" href="Data.String.html#1728" class="Function">rectangle</a> <a id="2208" class="Symbol">(</a><a id="2209" href="Data.Vec.Base.html#6515" class="Function">Vec.replicate</a> <a id="2223" class="Symbol">_</a> <a id="2225" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2227" href="Data.String.Base.html#3715" class="Function">padRight</a> <a id="2236" href="Data.String.html#2194" class="Bound">c</a><a id="2237" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2240" href="Data.String.html#2240" class="Function">rectangleᶜ</a> <a id="2251" class="Symbol">:</a> <a id="2253" class="Symbol">∀</a> <a id="2255" class="Symbol">{</a><a id="2256" href="Data.String.html#2256" class="Bound">n</a><a id="2257" class="Symbol">}</a> <a id="2259" class="Symbol">→</a> <a id="2261" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2266" class="Symbol">→</a> <a id="2268" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2273" class="Symbol">→</a> <a id="2275" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2279" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2286" href="Data.String.html#2256" class="Bound">n</a> <a id="2288" class="Symbol">→</a> <a id="2290" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="2294" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2301" href="Data.String.html#2256" class="Bound">n</a>
<a id="2303" href="Data.String.html#2240" class="Function">rectangleᶜ</a> <a id="2314" href="Data.String.html#2314" class="Bound">cₗ</a> <a id="2317" href="Data.String.html#2317" class="Bound">cᵣ</a> <a id="2320" class="Symbol">=</a> <a id="2322" href="Data.String.html#1728" class="Function">rectangle</a> <a id="2332" class="Symbol">(</a><a id="2333" href="Data.Vec.Base.html#6515" class="Function">Vec.replicate</a> <a id="2347" class="Symbol">_</a> <a id="2349" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2351" href="Data.String.Base.html#3836" class="Function">padBoth</a> <a id="2359" href="Data.String.html#2314" class="Bound">cₗ</a> <a id="2362" href="Data.String.html#2317" class="Bound">cᵣ</a><a id="2364" class="Symbol">)</a>
</pre></body></html>