<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A solver for equations over monoids</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Algebra.html" class="Module">Algebra</a>

<a id="285" class="Keyword">module</a> <a id="292" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="314" class="Symbol">{</a><a id="315" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="318" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="320" class="Symbol">}</a> <a id="322" class="Symbol">(</a><a id="323" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a> <a id="325" class="Symbol">:</a> <a id="327" href="Algebra.Bundles.html#6051" class="Record">Monoid</a> <a id="334" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="337" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="339" class="Symbol">)</a> <a id="341" class="Keyword">where</a>

<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="374" class="Symbol">as</a> <a id="377" class="Module">Fin</a>
<a id="381" class="Keyword">import</a> <a id="388" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="408" class="Symbol">as</a> <a id="411" class="Module">Fin</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="442" class="Keyword">hiding</a> <a id="449" class="Symbol">(</a><a id="450" href="Data.List.Base.html#6747" class="Function">lookup</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">import</a> <a id="465" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">Data.List.Relation.Binary.Equality.DecPropositional</a> <a id="517" class="Symbol">as</a> <a id="520" class="Module">ListEq</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="555" class="Symbol">as</a> <a id="558" class="Module">Maybe</a>
  <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="578" class="Symbol">;</a> <a id="580" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a><a id="590" class="Symbol">;</a> <a id="592" href="Data.Maybe.Base.html#1847" class="Function">From-just</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.Maybe.Base.html#1935" class="Function">from-just</a><a id="612" class="Symbol">)</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="640" class="Keyword">using</a> <a id="646" class="Symbol">(</a><a id="647" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="680" class="Keyword">using</a> <a id="686" class="Symbol">(</a><a id="687" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="690" class="Symbol">;</a> <a id="692" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="699" class="Symbol">)</a>
<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="727" class="Keyword">using</a> <a id="733" class="Symbol">(</a><a id="734" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a><a id="737" class="Symbol">;</a> <a id="739" href="Data.Vec.Base.html#1671" class="Function">lookup</a><a id="745" class="Symbol">)</a>
<a id="747" class="Keyword">open</a> <a id="752" class="Keyword">import</a> <a id="759" href="Function.Base.html" class="Module">Function.Base</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="783" class="Symbol">;</a> <a id="785" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="788" class="Symbol">)</a>
<a id="790" class="Keyword">open</a> <a id="795" class="Keyword">import</a> <a id="802" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="830" class="Keyword">using</a> <a id="836" class="Symbol">(</a><a id="837" href="Relation.Binary.Definitions.html#6788" class="Function">Decidable</a><a id="846" class="Symbol">)</a>

<a id="849" class="Keyword">open</a> <a id="854" class="Keyword">import</a> <a id="861" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="904" class="Keyword">using</a> <a id="910" class="Symbol">(</a><a id="911" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="914" class="Symbol">;</a> <a id="916" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="920" class="Symbol">)</a>
<a id="922" class="Keyword">import</a> <a id="929" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="956" class="Keyword">open</a> <a id="961" class="Keyword">import</a> <a id="968" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="985" class="Keyword">import</a> <a id="992" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1019" class="Symbol">as</a> <a id="1022" class="Module">Dec</a>

<a id="1027" class="Keyword">open</a> <a id="1032" href="Algebra.Bundles.html#6051" class="Module">Monoid</a> <a id="1039" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a>
<a id="1041" class="Keyword">open</a> <a id="1046" class="Keyword">import</a> <a id="1053" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="1086" href="Algebra.Structures.html#1390" class="Function">setoid</a>

<a id="1094" class="Comment">------------------------------------------------------------------------</a>
<a id="1167" class="Comment">-- Monoid expressions</a>

<a id="1190" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1252" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1301" class="Keyword">infixr</a> <a id="1308" class="Number">5</a> <a id="1310" href="Algebra.Solver.Monoid.html#1385" class="InductiveConstructor Operator">_⊕_</a>

<a id="1315" class="Keyword">data</a> <a id="Expr"></a><a id="1320" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1325" class="Symbol">(</a><a id="1326" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a> <a id="1328" class="Symbol">:</a> <a id="1330" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1331" class="Symbol">)</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1339" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1347" href="Algebra.Solver.Monoid.html#1347" class="InductiveConstructor">var</a> <a id="1351" class="Symbol">:</a> <a id="1353" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="1357" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a> <a id="1359" class="Symbol">→</a> <a id="1361" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1366" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1370" href="Algebra.Solver.Monoid.html#1370" class="InductiveConstructor">id</a>  <a id="1374" class="Symbol">:</a> <a id="1376" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1381" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1385" href="Algebra.Solver.Monoid.html#1385" class="InductiveConstructor Operator">_⊕_</a> <a id="1389" class="Symbol">:</a> <a id="1391" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1396" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1405" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a> <a id="1407" class="Symbol">→</a> <a id="1409" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1414" href="Algebra.Solver.Monoid.html#1326" class="Bound">n</a>

<a id="1417" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1475" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1483" class="Symbol">→</a> <a id="1485" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1489" class="Symbol">_</a>
<a id="1491" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="1495" href="Algebra.Solver.Monoid.html#1495" class="Bound">n</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1503" href="Algebra.Bundles.html#6130" class="Field">Carrier</a> <a id="1511" href="Algebra.Solver.Monoid.html#1495" class="Bound">n</a>

<a id="1514" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1585" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1598" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦_⟧</a> <a id="1602" class="Symbol">:</a> <a id="1604" class="Symbol">∀</a> <a id="1606" class="Symbol">{</a><a id="1607" href="Algebra.Solver.Monoid.html#1607" class="Bound">n</a><a id="1608" class="Symbol">}</a> <a id="1610" class="Symbol">→</a> <a id="1612" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="1617" href="Algebra.Solver.Monoid.html#1607" class="Bound">n</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="1625" href="Algebra.Solver.Monoid.html#1607" class="Bound">n</a> <a id="1627" class="Symbol">→</a> <a id="1629" href="Algebra.Bundles.html#6130" class="Field">Carrier</a>
<a id="1637" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="1639" href="Algebra.Solver.Monoid.html#1347" class="InductiveConstructor">var</a> <a id="1643" href="Algebra.Solver.Monoid.html#1643" class="Bound">x</a>   <a id="1647" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="1649" href="Algebra.Solver.Monoid.html#1649" class="Bound">ρ</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="1660" href="Algebra.Solver.Monoid.html#1649" class="Bound">ρ</a> <a id="1662" href="Algebra.Solver.Monoid.html#1643" class="Bound">x</a>
<a id="1664" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="1666" href="Algebra.Solver.Monoid.html#1370" class="InductiveConstructor">id</a>      <a id="1674" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="1676" href="Algebra.Solver.Monoid.html#1676" class="Bound">ρ</a> <a id="1678" class="Symbol">=</a> <a id="1680" href="Algebra.Bundles.html#6207" class="Field">ε</a>
<a id="1682" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="1684" href="Algebra.Solver.Monoid.html#1684" class="Bound">e₁</a> <a id="1687" href="Algebra.Solver.Monoid.html#1385" class="InductiveConstructor Operator">⊕</a> <a id="1689" href="Algebra.Solver.Monoid.html#1689" class="Bound">e₂</a> <a id="1692" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="1694" href="Algebra.Solver.Monoid.html#1694" class="Bound">ρ</a> <a id="1696" class="Symbol">=</a> <a id="1698" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="1700" href="Algebra.Solver.Monoid.html#1684" class="Bound">e₁</a> <a id="1703" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="1705" href="Algebra.Solver.Monoid.html#1694" class="Bound">ρ</a> <a id="1707" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="1709" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="1711" href="Algebra.Solver.Monoid.html#1689" class="Bound">e₂</a> <a id="1714" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="1716" href="Algebra.Solver.Monoid.html#1694" class="Bound">ρ</a>

<a id="1719" class="Comment">------------------------------------------------------------------------</a>
<a id="1792" class="Comment">-- Normal forms</a>

<a id="1809" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1851" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="1858" class="Symbol">:</a> <a id="1860" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1862" class="Symbol">→</a> <a id="1864" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1868" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="1875" href="Algebra.Solver.Monoid.html#1875" class="Bound">n</a> <a id="1877" class="Symbol">=</a> <a id="1879" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1884" class="Symbol">(</a><a id="1885" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="1889" href="Algebra.Solver.Monoid.html#1875" class="Bound">n</a><a id="1890" class="Symbol">)</a>

<a id="1893" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1929" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦_⟧⇓</a> <a id="1934" class="Symbol">:</a> <a id="1936" class="Symbol">∀</a> <a id="1938" class="Symbol">{</a><a id="1939" href="Algebra.Solver.Monoid.html#1939" class="Bound">n</a><a id="1940" class="Symbol">}</a> <a id="1942" class="Symbol">→</a> <a id="1944" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="1951" href="Algebra.Solver.Monoid.html#1939" class="Bound">n</a> <a id="1953" class="Symbol">→</a> <a id="1955" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="1959" href="Algebra.Solver.Monoid.html#1939" class="Bound">n</a> <a id="1961" class="Symbol">→</a> <a id="1963" href="Algebra.Bundles.html#6130" class="Field">Carrier</a>
<a id="1971" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="1973" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>     <a id="1980" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="1983" href="Algebra.Solver.Monoid.html#1983" class="Bound">ρ</a> <a id="1985" class="Symbol">=</a> <a id="1987" href="Algebra.Bundles.html#6207" class="Field">ε</a>
<a id="1989" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="1991" href="Algebra.Solver.Monoid.html#1991" class="Bound">x</a> <a id="1993" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1995" href="Algebra.Solver.Monoid.html#1995" class="Bound">nf</a> <a id="1998" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2001" href="Algebra.Solver.Monoid.html#2001" class="Bound">ρ</a> <a id="2003" class="Symbol">=</a> <a id="2005" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2012" href="Algebra.Solver.Monoid.html#2001" class="Bound">ρ</a> <a id="2014" href="Algebra.Solver.Monoid.html#1991" class="Bound">x</a> <a id="2016" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2018" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2020" href="Algebra.Solver.Monoid.html#1995" class="Bound">nf</a> <a id="2023" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2026" href="Algebra.Solver.Monoid.html#2001" class="Bound">ρ</a>

<a id="2029" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="2047" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2057" class="Symbol">:</a> <a id="2059" class="Symbol">∀</a> <a id="2061" class="Symbol">{</a><a id="2062" href="Algebra.Solver.Monoid.html#2062" class="Bound">n</a><a id="2063" class="Symbol">}</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="2072" href="Algebra.Solver.Monoid.html#2062" class="Bound">n</a> <a id="2074" class="Symbol">→</a> <a id="2076" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="2083" href="Algebra.Solver.Monoid.html#2062" class="Bound">n</a>
<a id="2085" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2095" class="Symbol">(</a><a id="2096" href="Algebra.Solver.Monoid.html#1347" class="InductiveConstructor">var</a> <a id="2100" href="Algebra.Solver.Monoid.html#2100" class="Bound">x</a><a id="2101" class="Symbol">)</a>   <a id="2105" class="Symbol">=</a> <a id="2107" href="Algebra.Solver.Monoid.html#2100" class="Bound">x</a> <a id="2109" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2111" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2114" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2124" href="Algebra.Solver.Monoid.html#1370" class="InductiveConstructor">id</a>        <a id="2134" class="Symbol">=</a> <a id="2136" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2139" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2149" class="Symbol">(</a><a id="2150" href="Algebra.Solver.Monoid.html#2150" class="Bound">e₁</a> <a id="2153" href="Algebra.Solver.Monoid.html#1385" class="InductiveConstructor Operator">⊕</a> <a id="2155" href="Algebra.Solver.Monoid.html#2155" class="Bound">e₂</a><a id="2157" class="Symbol">)</a> <a id="2159" class="Symbol">=</a> <a id="2161" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2171" href="Algebra.Solver.Monoid.html#2150" class="Bound">e₁</a> <a id="2174" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2177" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2187" href="Algebra.Solver.Monoid.html#2155" class="Bound">e₂</a>

<a id="2191" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2251" href="Algebra.Solver.Monoid.html#2251" class="Function">homomorphic</a> <a id="2263" class="Symbol">:</a> <a id="2265" class="Symbol">∀</a> <a id="2267" class="Symbol">{</a><a id="2268" href="Algebra.Solver.Monoid.html#2268" class="Bound">n</a><a id="2269" class="Symbol">}</a> <a id="2271" class="Symbol">(</a><a id="2272" href="Algebra.Solver.Monoid.html#2272" class="Bound">nf₁</a> <a id="2276" href="Algebra.Solver.Monoid.html#2276" class="Bound">nf₂</a> <a id="2280" class="Symbol">:</a> <a id="2282" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="2289" href="Algebra.Solver.Monoid.html#2268" class="Bound">n</a><a id="2290" class="Symbol">)</a> <a id="2292" class="Symbol">(</a><a id="2293" href="Algebra.Solver.Monoid.html#2293" class="Bound">ρ</a> <a id="2295" class="Symbol">:</a> <a id="2297" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="2301" href="Algebra.Solver.Monoid.html#2268" class="Bound">n</a><a id="2302" class="Symbol">)</a> <a id="2304" class="Symbol">→</a>
              <a id="2320" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2322" href="Algebra.Solver.Monoid.html#2272" class="Bound">nf₁</a> <a id="2326" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2329" href="Algebra.Solver.Monoid.html#2276" class="Bound">nf₂</a> <a id="2333" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2336" href="Algebra.Solver.Monoid.html#2293" class="Bound">ρ</a> <a id="2338" href="Algebra.Bundles.html#6151" class="Field Operator">≈</a> <a id="2340" class="Symbol">(</a><a id="2341" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2343" href="Algebra.Solver.Monoid.html#2272" class="Bound">nf₁</a> <a id="2347" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2350" href="Algebra.Solver.Monoid.html#2293" class="Bound">ρ</a> <a id="2352" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2354" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2356" href="Algebra.Solver.Monoid.html#2276" class="Bound">nf₂</a> <a id="2360" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2363" href="Algebra.Solver.Monoid.html#2293" class="Bound">ρ</a><a id="2364" class="Symbol">)</a>
<a id="2366" href="Algebra.Solver.Monoid.html#2251" class="Function">homomorphic</a> <a id="2378" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2381" href="Algebra.Solver.Monoid.html#2381" class="Bound">nf₂</a> <a id="2385" href="Algebra.Solver.Monoid.html#2385" class="Bound">ρ</a> <a id="2387" class="Symbol">=</a> <a id="2389" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="2397" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2399" href="Algebra.Solver.Monoid.html#2381" class="Bound">nf₂</a> <a id="2403" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2406" href="Algebra.Solver.Monoid.html#2385" class="Bound">ρ</a>      <a id="2413" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="2416" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2420" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2422" href="Algebra.Structures.html#4136" class="Function">identityˡ</a> <a id="2432" class="Symbol">_</a> <a id="2434" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="2438" href="Algebra.Bundles.html#6207" class="Field">ε</a> <a id="2440" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2442" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2444" href="Algebra.Solver.Monoid.html#2381" class="Bound">nf₂</a> <a id="2448" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2451" href="Algebra.Solver.Monoid.html#2385" class="Bound">ρ</a>  <a id="2454" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
<a id="2456" href="Algebra.Solver.Monoid.html#2251" class="Function">homomorphic</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Algebra.Solver.Monoid.html#2469" class="Bound">x</a> <a id="2471" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2473" href="Algebra.Solver.Monoid.html#2473" class="Bound">nf₁</a><a id="2476" class="Symbol">)</a> <a id="2478" href="Algebra.Solver.Monoid.html#2478" class="Bound">nf₂</a> <a id="2482" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2484" class="Symbol">=</a> <a id="2486" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="2494" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2501" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2503" href="Algebra.Solver.Monoid.html#2469" class="Bound">x</a> <a id="2505" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2507" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2509" href="Algebra.Solver.Monoid.html#2473" class="Bound">nf₁</a> <a id="2513" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2516" href="Algebra.Solver.Monoid.html#2478" class="Bound">nf₂</a> <a id="2520" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2523" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a>          <a id="2534" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="2537" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="2545" class="Symbol">(</a><a id="2546" href="Algebra.Solver.Monoid.html#2251" class="Function">homomorphic</a> <a id="2558" href="Algebra.Solver.Monoid.html#2473" class="Bound">nf₁</a> <a id="2562" href="Algebra.Solver.Monoid.html#2478" class="Bound">nf₂</a> <a id="2566" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a><a id="2567" class="Symbol">)</a> <a id="2569" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="2573" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2580" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2582" href="Algebra.Solver.Monoid.html#2469" class="Bound">x</a> <a id="2584" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2586" class="Symbol">(</a><a id="2587" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2589" href="Algebra.Solver.Monoid.html#2473" class="Bound">nf₁</a> <a id="2593" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2596" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2598" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2600" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2602" href="Algebra.Solver.Monoid.html#2478" class="Bound">nf₂</a> <a id="2606" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2609" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a><a id="2610" class="Symbol">)</a>  <a id="2613" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="2616" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2620" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2622" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="2628" class="Symbol">_</a> <a id="2630" class="Symbol">_</a> <a id="2632" class="Symbol">_</a> <a id="2634" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="2638" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2645" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2647" href="Algebra.Solver.Monoid.html#2469" class="Bound">x</a> <a id="2649" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2651" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2653" href="Algebra.Solver.Monoid.html#2473" class="Bound">nf₁</a> <a id="2657" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2660" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a> <a id="2662" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2664" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2666" href="Algebra.Solver.Monoid.html#2478" class="Bound">nf₂</a> <a id="2670" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2673" href="Algebra.Solver.Monoid.html#2482" class="Bound">ρ</a>    <a id="2678" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>

<a id="2681" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2743" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="2761" class="Symbol">:</a>
  <a id="2765" class="Symbol">∀</a> <a id="2767" class="Symbol">{</a><a id="2768" href="Algebra.Solver.Monoid.html#2768" class="Bound">n</a><a id="2769" class="Symbol">}</a> <a id="2771" class="Symbol">(</a><a id="2772" href="Algebra.Solver.Monoid.html#2772" class="Bound">e</a> <a id="2774" class="Symbol">:</a> <a id="2776" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="2781" href="Algebra.Solver.Monoid.html#2768" class="Bound">n</a><a id="2782" class="Symbol">)</a> <a id="2784" class="Symbol">(</a><a id="2785" href="Algebra.Solver.Monoid.html#2785" class="Bound">ρ</a> <a id="2787" class="Symbol">:</a> <a id="2789" href="Algebra.Solver.Monoid.html#1475" class="Function">Env</a> <a id="2793" href="Algebra.Solver.Monoid.html#2768" class="Bound">n</a><a id="2794" class="Symbol">)</a> <a id="2796" class="Symbol">→</a> <a id="2798" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2800" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="2810" href="Algebra.Solver.Monoid.html#2772" class="Bound">e</a> <a id="2812" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="2815" href="Algebra.Solver.Monoid.html#2785" class="Bound">ρ</a> <a id="2817" href="Algebra.Bundles.html#6151" class="Field Operator">≈</a> <a id="2819" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="2821" href="Algebra.Solver.Monoid.html#2772" class="Bound">e</a> <a id="2823" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="2825" href="Algebra.Solver.Monoid.html#2785" class="Bound">ρ</a>
<a id="2827" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="2845" class="Symbol">(</a><a id="2846" href="Algebra.Solver.Monoid.html#1347" class="InductiveConstructor">var</a> <a id="2850" href="Algebra.Solver.Monoid.html#2850" class="Bound">x</a><a id="2851" class="Symbol">)</a> <a id="2853" href="Algebra.Solver.Monoid.html#2853" class="Bound">ρ</a> <a id="2855" class="Symbol">=</a> <a id="2857" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="2865" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2872" href="Algebra.Solver.Monoid.html#2853" class="Bound">ρ</a> <a id="2874" href="Algebra.Solver.Monoid.html#2850" class="Bound">x</a> <a id="2876" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="2878" href="Algebra.Bundles.html#6207" class="Field">ε</a>  <a id="2881" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="2884" href="Algebra.Structures.html#4197" class="Function">identityʳ</a> <a id="2894" class="Symbol">_</a> <a id="2896" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="2900" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2907" href="Algebra.Solver.Monoid.html#2853" class="Bound">ρ</a> <a id="2909" href="Algebra.Solver.Monoid.html#2850" class="Bound">x</a>      <a id="2916" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
<a id="2918" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="2936" href="Algebra.Solver.Monoid.html#1370" class="InductiveConstructor">id</a> <a id="2939" href="Algebra.Solver.Monoid.html#2939" class="Bound">ρ</a> <a id="2941" class="Symbol">=</a> <a id="2943" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="2951" href="Algebra.Bundles.html#6207" class="Field">ε</a>  <a id="2954" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
<a id="2956" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="2974" class="Symbol">(</a><a id="2975" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a> <a id="2978" href="Algebra.Solver.Monoid.html#1385" class="InductiveConstructor Operator">⊕</a> <a id="2980" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a><a id="2982" class="Symbol">)</a> <a id="2984" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
  <a id="2996" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="2998" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3008" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a> <a id="3011" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="3014" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3024" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a> <a id="3027" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="3030" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a>        <a id="3039" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3042" href="Algebra.Solver.Monoid.html#2251" class="Function">homomorphic</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3065" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a><a id="3067" class="Symbol">)</a> <a id="3069" class="Symbol">(</a><a id="3070" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3080" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a><a id="3082" class="Symbol">)</a> <a id="3084" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a> <a id="3086" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="3090" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="3092" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3102" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a> <a id="3105" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="3108" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a> <a id="3110" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="3112" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="3114" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3124" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a> <a id="3127" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="3130" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a>  <a id="3133" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">≈⟨</a> <a id="3136" href="Algebra.Structures.html#1315" class="Function">∙-cong</a> <a id="3143" class="Symbol">(</a><a id="3144" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="3162" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a> <a id="3165" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a><a id="3166" class="Symbol">)</a> <a id="3168" class="Symbol">(</a><a id="3169" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a> <a id="3187" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a> <a id="3190" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a><a id="3191" class="Symbol">)</a> <a id="3193" href="Relation.Binary.Reasoning.Syntax.html#7049" class="Function">⟩</a>
  <a id="3197" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="3199" href="Algebra.Solver.Monoid.html#2975" class="Bound">e₁</a> <a id="3202" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="3204" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a> <a id="3206" href="Algebra.Bundles.html#6180" class="Field Operator">∙</a> <a id="3208" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="3210" href="Algebra.Solver.Monoid.html#2980" class="Bound">e₂</a> <a id="3213" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="3215" href="Algebra.Solver.Monoid.html#2984" class="Bound">ρ</a>                        <a id="3240" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>

<a id="3243" class="Comment">------------------------------------------------------------------------</a>
<a id="3316" class="Comment">-- &quot;Tactic.</a>

<a id="3329" class="Keyword">open</a> <a id="3334" class="Keyword">module</a> <a id="R"></a><a id="3341" href="Algebra.Solver.Monoid.html#3341" class="Module">R</a> <a id="3343" class="Symbol">=</a> <a id="3345" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3390" href="Algebra.Structures.html#1390" class="Function">setoid</a> <a id="3397" href="Algebra.Solver.Monoid.html#1347" class="InductiveConstructor">var</a> <a id="3401" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦_⟧</a> <a id="3405" class="Symbol">(</a><a id="3406" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦_⟧⇓</a> <a id="3411" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3413" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a><a id="3422" class="Symbol">)</a> <a id="3424" href="Algebra.Solver.Monoid.html#2743" class="Function">normalise-correct</a>
  <a id="3444" class="Keyword">public</a> <a id="3451" class="Keyword">using</a> <a id="3457" class="Symbol">(</a><a id="3458" href="Relation.Binary.Reflection.html#2560" class="Function">solve</a><a id="3463" class="Symbol">;</a> <a id="3465" href="Relation.Binary.Reflection.html#3665" class="Function Operator">_⊜_</a><a id="3468" class="Symbol">)</a>

<a id="3471" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3536" class="Keyword">infix</a> <a id="3542" class="Number">5</a> <a id="3544" href="Algebra.Solver.Monoid.html#3549" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3549" href="Algebra.Solver.Monoid.html#3549" class="Function Operator">_≟_</a> <a id="3553" class="Symbol">:</a> <a id="3555" class="Symbol">∀</a> <a id="3557" class="Symbol">{</a><a id="3558" href="Algebra.Solver.Monoid.html#3558" class="Bound">n</a><a id="3559" class="Symbol">}</a> <a id="3561" class="Symbol">→</a> <a id="3563" href="Relation.Binary.Definitions.html#6788" class="Function">Decidable</a> <a id="3573" class="Symbol">{</a><a id="3574" class="Argument">A</a> <a id="3576" class="Symbol">=</a> <a id="3578" href="Algebra.Solver.Monoid.html#1851" class="Function">Normal</a> <a id="3585" href="Algebra.Solver.Monoid.html#3558" class="Bound">n</a><a id="3586" class="Symbol">}</a> <a id="3588" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a>
<a id="3592" href="Algebra.Solver.Monoid.html#3592" class="Bound">nf₁</a> <a id="3596" href="Algebra.Solver.Monoid.html#3549" class="Function Operator">≟</a> <a id="3598" href="Algebra.Solver.Monoid.html#3598" class="Bound">nf₂</a> <a id="3602" class="Symbol">=</a> <a id="3604" href="Relation.Nullary.Decidable.Core.html#4934" class="Function">Dec.map′</a> <a id="3613" href="Data.List.Relation.Binary.Equality.Propositional.html#1047" class="Function">≋⇒≡</a> <a id="3617" href="Data.List.Relation.Binary.Equality.Propositional.html#1135" class="Function">≡⇒≋</a> <a id="3621" class="Symbol">(</a><a id="3622" href="Algebra.Solver.Monoid.html#3592" class="Bound">nf₁</a> <a id="3626" href="Data.List.Relation.Binary.Equality.DecSetoid.html#1047" class="Function Operator">≋?</a> <a id="3629" href="Algebra.Solver.Monoid.html#3598" class="Bound">nf₂</a><a id="3632" class="Symbol">)</a>
  <a id="3636" class="Keyword">where</a> <a id="3642" class="Keyword">open</a> <a id="3647" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3654" href="Data.Fin.Properties.html#3668" class="Function Operator">Fin._≟_</a>

<a id="3663" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3732" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3796" href="Algebra.Solver.Monoid.html#3796" class="Function">prove′</a> <a id="3803" class="Symbol">:</a> <a id="3805" class="Symbol">∀</a> <a id="3807" class="Symbol">{</a><a id="3808" href="Algebra.Solver.Monoid.html#3808" class="Bound">n</a><a id="3809" class="Symbol">}</a> <a id="3811" class="Symbol">(</a><a id="3812" href="Algebra.Solver.Monoid.html#3812" class="Bound">e₁</a> <a id="3815" href="Algebra.Solver.Monoid.html#3815" class="Bound">e₂</a> <a id="3818" class="Symbol">:</a> <a id="3820" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="3825" href="Algebra.Solver.Monoid.html#3808" class="Bound">n</a><a id="3826" class="Symbol">)</a> <a id="3828" class="Symbol">→</a> <a id="3830" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3836" class="Symbol">(∀</a> <a id="3839" href="Algebra.Solver.Monoid.html#3839" class="Bound">ρ</a> <a id="3841" class="Symbol">→</a> <a id="3843" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="3845" href="Algebra.Solver.Monoid.html#3812" class="Bound">e₁</a> <a id="3848" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="3850" href="Algebra.Solver.Monoid.html#3839" class="Bound">ρ</a> <a id="3852" href="Algebra.Bundles.html#6151" class="Field Operator">≈</a> <a id="3854" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="3856" href="Algebra.Solver.Monoid.html#3815" class="Bound">e₂</a> <a id="3859" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="3861" href="Algebra.Solver.Monoid.html#3839" class="Bound">ρ</a><a id="3862" class="Symbol">)</a>
<a id="3864" href="Algebra.Solver.Monoid.html#3796" class="Function">prove′</a> <a id="3871" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="3874" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a> <a id="3877" class="Symbol">=</a>
  <a id="3881" href="Data.Maybe.Base.html#2049" class="Function">Maybe.map</a> <a id="3891" href="Algebra.Solver.Monoid.html#3950" class="Function">lemma</a> <a id="3897" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3899" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a> <a id="3910" class="Symbol">(</a><a id="3911" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3921" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="3924" href="Algebra.Solver.Monoid.html#3549" class="Function Operator">≟</a> <a id="3926" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3936" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a><a id="3938" class="Symbol">)</a>
  <a id="3942" class="Keyword">where</a>
  <a id="3950" href="Algebra.Solver.Monoid.html#3950" class="Function">lemma</a> <a id="3956" class="Symbol">:</a> <a id="3958" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3968" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="3971" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3973" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="3983" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a> <a id="3986" class="Symbol">→</a> <a id="3988" class="Symbol">∀</a> <a id="3990" href="Algebra.Solver.Monoid.html#3990" class="Bound">ρ</a> <a id="3992" class="Symbol">→</a> <a id="3994" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="3996" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="3999" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="4001" href="Algebra.Solver.Monoid.html#3990" class="Bound">ρ</a> <a id="4003" href="Algebra.Bundles.html#6151" class="Field Operator">≈</a> <a id="4005" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟦</a> <a id="4007" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a> <a id="4010" href="Algebra.Solver.Monoid.html#1598" class="Function Operator">⟧</a> <a id="4012" href="Algebra.Solver.Monoid.html#3990" class="Bound">ρ</a>
  <a id="4016" href="Algebra.Solver.Monoid.html#3950" class="Function">lemma</a> <a id="4022" href="Algebra.Solver.Monoid.html#4022" class="Bound">eq</a> <a id="4025" href="Algebra.Solver.Monoid.html#4025" class="Bound">ρ</a> <a id="4027" class="Symbol">=</a>
    <a id="4033" href="Relation.Binary.Reflection.html#1874" class="Function">R.prove</a> <a id="4041" href="Algebra.Solver.Monoid.html#4025" class="Bound">ρ</a> <a id="4043" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="4046" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a> <a id="4049" class="Symbol">(</a><a id="4050" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="4062" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="4064" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="4074" href="Algebra.Solver.Monoid.html#3871" class="Bound">e₁</a> <a id="4077" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="4080" href="Algebra.Solver.Monoid.html#4025" class="Bound">ρ</a>  <a id="4083" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="4086" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4091" class="Symbol">(λ</a> <a id="4094" href="Algebra.Solver.Monoid.html#4094" class="Bound">e</a> <a id="4096" class="Symbol">→</a> <a id="4098" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="4100" href="Algebra.Solver.Monoid.html#4094" class="Bound">e</a> <a id="4102" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="4105" href="Algebra.Solver.Monoid.html#4025" class="Bound">ρ</a><a id="4106" class="Symbol">)</a> <a id="4108" href="Algebra.Solver.Monoid.html#4022" class="Bound">eq</a> <a id="4111" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="4119" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟦</a> <a id="4121" href="Algebra.Solver.Monoid.html#2047" class="Function">normalise</a> <a id="4131" href="Algebra.Solver.Monoid.html#3874" class="Bound">e₂</a> <a id="4134" href="Algebra.Solver.Monoid.html#1929" class="Function Operator">⟧⇓</a> <a id="4137" href="Algebra.Solver.Monoid.html#4025" class="Bound">ρ</a>  <a id="4140" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a><a id="4141" class="Symbol">)</a>

<a id="4144" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4195" href="Algebra.Solver.Monoid.html#4195" class="Function">prove</a> <a id="4201" class="Symbol">:</a> <a id="4203" class="Symbol">∀</a> <a id="4205" href="Algebra.Solver.Monoid.html#4205" class="Bound">n</a> <a id="4207" class="Symbol">(</a><a id="4208" href="Algebra.Solver.Monoid.html#4208" class="Bound">es</a> <a id="4211" class="Symbol">:</a> <a id="4213" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="4218" href="Algebra.Solver.Monoid.html#4205" class="Bound">n</a> <a id="4220" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4222" href="Algebra.Solver.Monoid.html#1320" class="Datatype">Expr</a> <a id="4227" href="Algebra.Solver.Monoid.html#4205" class="Bound">n</a><a id="4228" class="Symbol">)</a> <a id="4230" class="Symbol">→</a>
        <a id="4240" href="Data.Maybe.Base.html#1847" class="Function">From-just</a> <a id="4250" class="Symbol">(</a><a id="4251" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4259" href="Algebra.Solver.Monoid.html#3796" class="Function">prove′</a> <a id="4266" href="Algebra.Solver.Monoid.html#4208" class="Bound">es</a><a id="4268" class="Symbol">)</a>
<a id="4270" href="Algebra.Solver.Monoid.html#4195" class="Function">prove</a> <a id="4276" class="Symbol">_</a> <a id="4278" class="Symbol">=</a> <a id="4280" href="Data.Maybe.Base.html#1935" class="Function">from-just</a> <a id="4290" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4292" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4300" href="Algebra.Solver.Monoid.html#3796" class="Function">prove′</a>
</pre></body></html>